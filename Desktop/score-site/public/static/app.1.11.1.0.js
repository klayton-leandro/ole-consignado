function provideDefaultOptions(e){for(var n=[],t={fields:[],formatField:function(e,n){return String(n)}},i=0;i<e.length;i++){var o=e[i];for(var a in o)if("[object Object]"===Object.prototype.toString.call(o[a]))for(var r in o[a]){var s=a+"."+r;n.indexOf(s)===-1&&n.push(s)}else n.indexOf(a)===-1&&n.push(a)}for(var i=0;i<n.length;++i)t.fields.push({key:n[i],name:n[i]});return t}function ISODateString(e){function n(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"Z"}function registerComponent(e,n){_components.push({selector:e,constructor:n}),$(window).on("load",function(){$.each(_components,function(e,n){$.each($(n.selector),function(e,t){if(!t.initialized){t.initialized=!0;var i=new n.constructor($(t));i.init&&i.init()}})})})}function randomPassword(e){for(var n="",t="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789",i=0;i<e;i++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}function ns(e){if(0!==e.indexOf("lending"))throw e+" is an invalid namespace. Must start with lending";split=e.split("."),split.shift(1);for(var n=lending,t=0;t<split.length;t++){var i=split[t];n[i]=n[i]||{},n=n[i]}return n}function gatherFormData(e,n){var t={};n=n||{};var i=e.find(":input:disabled").removeAttr("disabled");return $.each(e.serializeArray(),function(e,i){var o=i.name,a=i.value,r=t;if(o.indexOf(".")!==-1){var s=o.substring(0,o.indexOf("."));t.hasOwnProperty(s)||(t[s]={}),o=o.substring(o.lastIndexOf(".")+1),r=t[s]}t.hasOwnProperty(o)?(r[o]=$.makeArray(r[o]),""!==a&&r[o].push(a)):(void 0!==n[i.name]&&(a=n[i.name](a)),r[o]=a)}),i.attr("disabled","disabled"),t}function merge(e,n){for(var t in e)n[t]=e[t];return n}function populate(e){var n=this;return n.element=e,n["with"]=function(e){for(var t in e){var i=n.element.find('[name="'+t+'"]');0===i.length&&(i=n.element.find('[data-populate-with="'+t+'"]'));var o=e[t];if("radio"===i.attr("type")){if(null===o)continue;for(var a=0;a<i.length;a++)radio=$(i[a]),radio.val()!==o&&radio.val()!==o.toString()||radio.prop("checked",!0)}else i.is("input")||i.is("textarea")?i.val(o):i.is("select")?i.find('option[value="'+o+'"]').length>0&&i.val(o):i.html(o)}},n}function debounce(e,n,t){var i;return function(){var o=this,a=arguments,r=function(){i=null,t||e.apply(o,a)},s=t&&!i;clearTimeout(i),i=setTimeout(r,n),s&&e.apply(o,a)}}function isFunction(e){var n={};return e&&"[object Function]"===n.toString.call(e)}function isObject(e){return null!==e&&"object"==typeof e}function isArray(e){return null!==e&&"[object Array]"===Object.prototype.toString.call(e)}function splitRemoveEmpty(e,n){for(var t=e.split(n),i=[],o=0;o<t.length;o++){var a=t[o];""!==a&&i.push(a)}return i}function getCookie(e){for(var n=e+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var o=t[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return null}function setCookie(e,n,t){var i=e+"="+n;t&&(i+=";expires="+t.toGMTString()),document.cookie=i+"; path=/"}function removeCookie(e){var n=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT";document.cookie=n}function allQueryStrings(){var e=window.location.search;if(0===e.length)return{};if(e=e.substring(1),0===e.length)return{};var n=e.split("&");if(0===n.length)return{};for(var t={},i=0;i<n.length;i++){var o=n[i],a=o.split("=");if(2===a.length){var r=a[0],s=a[1];t[r]=s}}return t}function querystring(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),t=n.exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function moneyToNumber(e){return null!=e&&e.length>0?Number(e.replace(/\D/g,"")):0}function stringToUpper(e){return null!=e?e.toUpperCase():e}function stringToLower(e){return null!=e?e.toLowerCase():e}function disableSubmit(){$('button[type="submit"]').attr("disabled","disabled"),$('button[type="submit"]').find("i").attr("disabled","disabled")}function enableSubmit(){$('button[type="submit"]').removeAttr("disabled","disabled"),$('button[type="submit"]').find("i").removeAttr("disabled","disabled")}function diffDates(e){return now=moment(new Date),null===e?end=moment(new Date):end=moment(e),console.log(now.diff(end,"days")),now.diff(end,"days")}function goTopPage(){$("html, body").animate({scrollTop:0},"slow")}function setFormType(e){"cp"==e?(sessionStorage.setItem("formType",JSON.stringify({securityIsOwned:!0,securityType:"no-security",defaultForm:!0})),void 0!==sessionStorage.getItem("formType")&&null!==sessionStorage.getItem("formType")&&(window.location.href="/me/newapplication")):"car"==e?(sessionStorage.setItem("formType",JSON.stringify({securityIsOwned:!0,securityType:"car",defaultForm:!1})),void 0!==sessionStorage.getItem("formType")&&null!==sessionStorage.getItem("formType")&&(window.location.href="/me/newapplication")):"home"==e?(sessionStorage.setItem("formType",JSON.stringify({securityIsOwned:!0,securityType:"home",defaultForm:!0})),void 0!==sessionStorage.getItem("formType")&&null!==sessionStorage.getItem("formType")&&(window.location.href="/me/newapplication")):"fin"==e&&(sessionStorage.setItem("formType",JSON.stringify({securityIsOwned:!1,securityType:"car",defaultForm:!0})),void 0!==sessionStorage.getItem("formType")&&null!==sessionStorage.getItem("formType")&&(window.location.href="/me/newapplication"))}function showModalMe(e){"cp"==e?$(".modal-cp").iziModal("open"):"car"==e?$(".modal-car").iziModal("open"):"home"==e?$(".modal-home").iziModal("open"):"fin"==e&&$(".modal-fin").iziModal("open")}function showAlertAppDisabled(e){return 30-e}function showModalMeDisabled(e){"cp"==e?$(".modal-cp-disabled").iziModal("open"):"car"==e?$(".modal-car-disabled").iziModal("open"):"home"==e?$(".modal-home-disabled").iziModal("open"):"fin"==e&&$(".modal-fin-disabled").iziModal("open")}function setValidationError(e,n){var t=1===e.parents(".input-container").length?e.parents(".input-container")[0]:null,i=$('<div class="validation-errors">').html(n.join("<br />"));t?$(t).children().last().after(i):e.siblings().length>0&&!e.is(":last-child")?e.siblings().last().after(i):e.after(i),e.parents(".input-container").addClass("invalid")}function validateForm(e,n){var t=!0,i=function(e){var n=!1;if(e.is(":visible")||"hidden"===e.attr("type")){var i=[];$.each(e.context.attributes,function(t,o){var a=o.name,r=o.value;if(0===a.indexOf("data-validate-")){var s=a.split("-")[2];if(validators.hasOwnProperty(s)){var l=validators[s](e,r);if(l&&l.hasError===!0)return n=!0,i.push(l.message),!1}else console.warn("Error: missing validator for "+s)}}),e.parents(".input-container").removeClass("invalid");var o=1===e.parents(".input-container").length?e.parents(".input-container")[0]:null;if(o?$(o).children(".validation-errors").remove():e.siblings(".validation-errors").remove(),n===!0){t=!1;var a=$('<div class="validation-errors">').html(i.join("<br />"));o?$(o).children().last().after(a):e.siblings().length>0&&!e.is(":last-child")?e.siblings().last().after(a):e.after(a),e.parents(".input-container").addClass("invalid")}}};return e.find("[data-validate]").each(function(e,t){t=$(t).first(),n?t[0].name==n&&(i(t),t.on("change",function(){i($(this))})):(i(t),t.on("change",function(){i($(this))}))}),t}function gatherApplicationFormData(e){var n=gatherFormData(e,{accountMonthsActive:Number,appliedAmount:moneyToNumber,monthlyIncome:moneyToNumber,householdMonthlyIncome:moneyToNumber,loanPeriodInMonths:Number,housingTime:Number,"vehicleSecurity.modelYear":Number,"vehicleSecurity.value":moneyToNumber,"vehicleSecurity.registrationNumber":stringToUpper,"vehicleSecurity.manufacturingYear":Number,"vehicleSecurity.numberOfExistingLoans":Number,"vehicleSecurity.valueOfExistingLoans":Number,"vehicleSecurity.downPayment":moneyToNumber,"homeSecurity.value":moneyToNumber,incomePaymentDay:Number,netWorth:Number});return""===n.accountOpenDate&&delete n.accountOpenDate,n}function countActiveBids(e){var n=0;if(null==e.auction||null==e.auction.bids)return 0;for(var t=0;t<e.auction.bids.length;t++)1!=e.auction.bids[t].rejected&&n++;return n}function describeWorkStatus(e){switch(e){case"private-employee":return"Funcionário do setor privado";case"public-employee":return"Funcionário público";case"independent-contractor":return"Autônomo";case"business-owner":return"Empresário";case"liberal-professional":return"Profissional Liberal";case"retired":return"Aposentado ou Pensionista";case"unemployed":return"Desempregado";default:return"? ("+e+")"}}function applicationHumanFormatter(e,n){switch(n){case"appliedAmount":if("car"===e.securityType&&e.securityIsOwned===!1){var t=e.vehicleSecurity.value-e.vehicleSecurity.downPayment;return t=0|t,numeral(t).format("$ 0,0.00")}return numeral(e[n]).format("$ 0,0.00");case"created":return moment(e.created).format("D/MMM/YYYY, HH:mm:ss");case"applicationState":switch(e.applicationState){case 1:return"Em cadastro";case 2:return"Cadastrada";case 4:return"Em análise";case 8:return"Proposta enviada";case 16:return"Encerrada";case 32:return"Proposta aceita";case 64:return"Em follow-up";case 128:return"Paga";default:return"n/a"}case"hasCompletedApplication":var i=e.uiState.hasCompletedApplication?"Sim":"Não";return i;case"accountType":switch(e.accountType){case"checking":return"Conta Corrente";case"savings":return"Conta Poupança";case"salary":return"Conta Salário";default:return""}case"workStatus":return describeWorkStatus(e.workStatus);case"productName":return"no-security"===e.securityType?"Empréstimo Pessoal":"car"===e.securityType?e.securityIsOwned===!1?"Financiamento de veículo":"Refinanciamento de Veículo":"home"===e.securityType?"Refinanciamento de Imóvel":"n/d";case"birthDate":return moment(e.birthDate).format("DD/MM/YYYY");case"hasCreditRestrictions":return e.hasCreditRestrictions?"Sim":"Não";default:return String(e[n])}}var lending=lending||{};lending.app=function(){var e=this;return e.init=function(){e.$container=$("#container"),e.initApi(),e.initControllers(),e.initRouting(),e.initDomains(),moment.locale("pt-br"),numeral.language("pt-br")},e.initApi=function(){e.api=new lending.core.api,e.api.on("logged-out",function(){var n=window.location.pathname;n.indexOf("/login")===-1&&"/"!==n&&e.router.routeTo("/login?return="+n)}),e.api.tokenProvider=e.getAuth},e.initDomains=function(){e.api.loadDomains()},e.initControllers=function(){e.homeController=new lending.controllers.home({app:e}),e.meController=new lending.controllers.me({app:e}),e.loginController=new lending.controllers.login({app:e}),e.adminController=new lending.controllers.admin({app:e}),e.crmController=new lending.controllers.crm({app:e}),e.partnerController=new lending.controllers.partner({app:e}),e.campaignController=new lending.controllers.campaigns({app:e})},e.initRouting=function(){var n={__404:e.homeController.error404,__home:function(){e.verifyAuth(function(n){null!==n?($(".public-site-content-container").show(),$(".footer-container").show()):e.routeAfterLogin()})},"emprestimo-pessoal":{index:function(){e.verifyAuth(function(n){null!==n?($(".public-site-content-container").show(),$(".footer-container").show()):e.routeAfterLogin()})}},"refinanciamento-de-imovel":{index:function(){e.verifyAuth(function(n){null!==n?($(".public-site-content-container").show(),$(".footer-container").show()):e.routeAfterLogin()})}},"refinanciamento-veiculo":{index:function(){e.verifyAuth(function(n){null!==n?($(".public-site-content-container").show(),$(".footer-container").show()):e.routeAfterLogin()})}},"financiamento-veiculo":{index:function(){e.verifyAuth(function(n){null!==n?($(".public-site-content-container").show(),$(".footer-container").show()):e.routeAfterLogin()})}},campaigns:{":campaign_name":{":id":{index:e.campaignController.view}}},campaign:{expired:e.campaignController.expired,":supplier":{":campaign_name":{":id":{index:e.campaignController.view}}}},parceiros:{index:e.partnerController.index,ibi:e.partnerController.ibi},terms:{index:function(){e.setView(templatizer.terms.index,{})}},me:{index:e.meController.index,newapplication:e.meController.newapplication,applications:{":id":{index:e.meController.applications.view,offers:{":id":{index:e.meController.offers.index,accepted:e.meController.offers.accepted}}}}},login:{index:e.loginController.index,token:{":token":{index:e.loginController.loginFromToken}},password:{index:e.loginController.loginWithPassword}},logout:{index:function(){e.clearAuth(),window.location.href="/"}},crm:{index:e.crmController.index,applications:{index:e.crmController.applications.index,":id":{index:e.crmController.applications.view}}},admin:{index:e.adminController.index,auth:{index:e.adminController.auth.index,create:e.adminController.auth.create,":id":{index:e.adminController.auth.view}},applications:{index:e.adminController.applications.index,":id":{index:e.adminController.applications.view}},"export":{index:e.adminController["export"].index},suppliers:{index:e.adminController.suppliers.index,create:e.adminController.suppliers.create,":id":{index:e.adminController.suppliers.view}}}};e.router=new lending.core.router({routeMap:n}),e.router.init()},e.setView=function(n,t){t=t||{};var i={user:e.getCurrentUser(),isAdmin:e.isAdmin(),isAdvisor:e.isAdvisor(),isSales:e.isSales(),isCustomer:e.isCustomer()},o=$.extend(t,i),a=$(n(o));e.$container.html(""),e.$container.append(a),$(window).trigger("load")},e.setAuth=function(e){var n=new Date;n.setDate(n.getDate()+7),setCookie("token",e,n)},e.getAuth=function(){var n=getCookie("token");return n&&n.length>0&&e.setAuth(n),n},e.clearAuth=function(){localStorage.removeItem("currentUser"),$.each(document.cookie.split(/; */),function(){var e=this.split("=");removeCookie(e[0])})},e.setCurrentUser=function(e){localStorage.setItem("currentUser",JSON.stringify(e))},e.getCurrentUser=function(){var e=localStorage.getItem("currentUser");if(null===e)return null;try{return JSON.parse(e)}catch(n){return null}},e.ensureRole=function(n){for(var t=0;t<n.length;t++)if(e.isInRole(n[t]))return!0;return!1},e.makeProtectionWrapper=function(n,t,i){return function(){return e.ensureRole(i)?void t.apply(n,arguments):void e.router.routeTo("/login?return="+window.location.pathname+encodeURIComponent(window.location.search))}},e.protectWithRoleLevel=function(n){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)if("function"==typeof i[o]){i[o];i[o]=e.makeProtectionWrapper(i,i[o],n)}}},e.getTrackingData=function(){var e=allQueryStrings();return e.source="Finanzero",e.referrer=document.referrer,e},e.getCurrentApplication=function(n){e.api.applications.init({trackingData:e.getTrackingData()},function(e,t){n(e,t)})},e.clearCurrentApplication=function(){removeCookie("applicationId")},e.verifyAuth=function(n){var t=e.getAuth();return null===t?void n({err:"no token"}):void e.api.auth.validate(function(t,i){!t&&i&&e.setCurrentUser(i),n(t)})},e.routeAfterLogin=function(){var n=querystring("return");if(""!==n)return void e.router.routeTo(n);var t=e.getCurrentUser();if(null===t)return void e.router.routeTo("/login");switch(t.role){case"customer":e.router.routeTo("/me");break;case"admin":e.router.routeTo("/admin");break;case"sales":case"advisor":alert("Por favor utilize a nova aplicação COF em cof.finanzero.com.br"),e.router.routeTo("/logout");break;case"supplier":alert("Por favor utilize a nova aplicação COF em cof.finanzero.com.br"),e.router.routeTo("/logout");break;default:e.router.routeTo("/")}},e.showLoader=function(){$(".loading-indicator").show(),setTimeout(function(){$(".loading-indicator").addClass("activate-animation")},10)},e.hideLoader=function(){$(".loading-indicator").removeClass("activate-animation"),setTimeout(function(){$(".loading-indicator").hide()},300)},e.isAdmin=function(){return e.isInRole("admin")},e.isCustomer=function(){return e.isInRole("customer")},e.isSales=function(){return e.isInRole("sales")},e.isAdvisor=function(){return e.isInRole("advisor")},e.isInRole=function(n){var t=e.getCurrentUser();return null!==t&&t.role===n},e},$(document).ready(function(){var e=$("#container");window.app=new lending.app(e),window.app.init()});var CSVExport={csvDownload:function(e,n,t){var i=CSVExport.jsonToCsv(e,t),o=new Blob([i],{type:"text/plain;charset=utf-8"});saveAs(o,n+".csv")},jsonToCsv:function(e,n){var t="",i=0,o=0,a=null,r=null;for(n=n||provideDefaultOptions(e),i=0;i<n.fields.length;i++)a=n.fields[i],t=t+a.name+";";t+="\n";var s=function(e){return void 0===e||null===e?"":String(e)};for(i=0;i<e.length;i++){for(r=e[i],o=0;o<n.fields.length;o++)if(keys=n.fields[o].key.split("."),formatFunc=n.fields[o].format||s,1==keys.length)try{t+=formatFunc(r[keys[0]])+";"}catch(l){t+=";"}else if(2==keys.length)try{t+=formatFunc(r[keys[0]][keys[1]])+";"}catch(l){t+=";"}t+="\n"}return t}},lending=lending||{},_components=[];!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(n,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(n)),e(t),t}:e(jQuery)}(function(e){function n(){var e,n=document.createElement("fakeelement"),t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in t)if(void 0!==n.style[e])return t[e]}function t(e){return e=e||navigator.userAgent,e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1}function i(e){var n=/%|px|em|cm|vh|vw/;return parseInt(String(e).split(n)[0])}var o=e(window),a=e(document),r="iziModal",s={CLOSING:"closing",CLOSED:"closed",OPENING:"opening",OPENED:"opened",DESTROYED:"destroyed"},l=n(),d=!!/Mobi/.test(navigator.userAgent),p=0,c=function(e,n){this.init(e,n)};return c.prototype={constructor:c,init:function(n,t){var i=this;this.$element=e(n),void 0!==this.$element[0].id&&""!==this.$element[0].id?this.id=this.$element[0].id:(this.id=r+Math.floor(1e7*Math.random()+1),this.$element.attr("id",this.id)),this.classes=void 0!==this.$element.attr("class")?this.$element.attr("class"):"",this.content=this.$element.html(),this.state=s.CLOSED,this.options=t,this.width=0,this.timer=null,this.timerTimeout=null,this.progressBar=null,this.isPaused=!1,this.isFullscreen=!1,this.headerHeight=0,this.modalHeight=0,this.$overlay=e('<div class="'+r+'-overlay" style="background-color:'+t.overlayColor+'"></div>'),this.$navigate=e('<div class="'+r+'-navigate"><div class="'+r+'-navigate-caption">Use</div><button class="'+r+'-navigate-prev"></button><button class="'+r+'-navigate-next"></button></div>'),this.group={name:this.$element.attr("data-"+r+"-group"),index:null,ids:[]},this.$element.attr("aria-hidden","true"),this.$element.attr("aria-labelledby",this.id),this.$element.attr("role","dialog"),this.$element.hasClass("iziModal")||this.$element.addClass("iziModal"),void 0===this.group.name&&""!==t.group&&(this.group.name=t.group,this.$element.attr("data-"+r+"-group",t.group)),this.options.loop===!0&&this.$element.attr("data-"+r+"-loop",!0),e.each(this.options,function(e,n){var o=i.$element.attr("data-"+r+"-"+e);try{"undefined"!=typeof o&&(""===o||"true"==o?t[e]=!0:"false"==o?t[e]=!1:"function"==typeof n?t[e]=new Function(o):t[e]=o)}catch(a){}}),t.appendTo!==!1&&this.$element.appendTo(t.appendTo),t.iframe===!0?(this.$element.html('<div class="'+r+'-wrap"><div class="'+r+'-content"><iframe class="'+r+'-iframe"></iframe>'+this.content+"</div></div>"),null!==t.iframeHeight&&this.$element.find("."+r+"-iframe").css("height",t.iframeHeight)):this.$element.html('<div class="'+r+'-wrap"><div class="'+r+'-content">'+this.content+"</div></div>"),this.$wrap=this.$element.find("."+r+"-wrap"),null===t.zindex||isNaN(parseInt(t.zindex))||(this.$element.css("z-index",t.zindex),this.$navigate.css("z-index",t.zindex-1),this.$overlay.css("z-index",t.zindex-2)),""!==t.radius&&this.$element.css("border-radius",t.radius),""!==t.padding&&this.$element.find("."+r+"-content").css("padding",t.padding),""!==t.theme&&("light"===t.theme?this.$element.addClass(r+"-light"):this.$element.addClass(t.theme)),t.rtl===!0&&this.$element.addClass(r+"-rtl"),t.openFullscreen===!0&&(this.isFullscreen=!0,this.$element.addClass("isFullscreen")),this.createHeader(),this.recalcWidth(),this.recalcVerticalPos()},createHeader:function(){this.$header=e('<div class="'+r+'-header"><h2 class="'+r+'-header-title">'+this.options.title+'</h2><p class="'+r+'-header-subtitle">'+this.options.subtitle+'</p><div class="'+r+'-header-buttons"></div></div>'),this.options.closeButton===!0&&this.$header.find("."+r+"-header-buttons").append('<a href="javascript:void(0)" class="'+r+"-button "+r+'-button-close" data-'+r+"-close></a>"),this.options.fullscreen===!0&&this.$header.find("."+r+"-header-buttons").append('<a href="javascript:void(0)" class="'+r+"-button "+r+'-button-fullscreen" data-'+r+"-fullscreen></a>"),this.options.timeoutProgressbar!==!0||isNaN(parseInt(this.options.timeout))||this.options.timeout===!1||0===this.options.timeout||this.$header.prepend('<div class="'+r+'-progressbar"><div style="background-color:'+this.options.timeoutProgressbarColor+'"></div></div>'),""===this.options.subtitle&&this.$header.addClass(r+"-noSubtitle"),""!==this.options.title&&(null!==this.options.headerColor&&(this.options.borderBottom===!0&&this.$element.css("border-bottom","3px solid "+this.options.headerColor),this.$header.css("background",this.options.headerColor)),null===this.options.icon&&null===this.options.iconText||(this.$header.prepend('<i class="'+r+'-header-icon"></i>'),null!==this.options.icon&&this.$header.find("."+r+"-header-icon").addClass(this.options.icon).css("color",this.options.iconColor),null!==this.options.iconText&&this.$header.find("."+r+"-header-icon").html(this.options.iconText)),this.$element.css("overflow","hidden").prepend(this.$header))},setGroup:function(n){var t=this,i=this.group.name||n;if(this.group.ids=[],void 0!==n&&n!==this.group.name&&(i=n,this.group.name=i,this.$element.attr("data-"+r+"-group",i)),void 0!==i&&""!==i){var o=0;e.each(e("."+r+"[data-"+r+"-group="+i+"]"),function(n,i){t.group.ids.push(e(this)[0].id),t.id==e(this)[0].id&&(t.group.index=o),o++})}},toggle:function(){this.state==s.OPENED&&this.close(),this.state==s.CLOSED&&this.open()},open:function(n){function t(){o.state=s.OPENED,o.$element.trigger(s.OPENED),o.options.onOpened&&"function"==typeof o.options.onOpened&&o.options.onOpened(o)}function i(){o.$element.off("click","[data-"+r+"-close]").on("click","[data-"+r+"-close]",function(n){n.preventDefault();var t=e(n.currentTarget).attr("data-"+r+"-transitionOut");void 0!==t?o.close({transition:t}):o.close()}),o.$element.off("click","[data-"+r+"-fullscreen]").on("click","[data-"+r+"-fullscreen]",function(e){e.preventDefault(),o.isFullscreen===!0?(o.isFullscreen=!1,o.$element.removeClass("isFullscreen")):(o.isFullscreen=!0,o.$element.addClass("isFullscreen")),o.options.onFullscreen&&"function"==typeof o.options.onFullscreen&&o.options.onFullscreen(o),o.$element.trigger("fullscreen",o)}),o.$navigate.off("click","."+r+"-navigate-next").on("click","."+r+"-navigate-next",function(e){o.next(e)}),o.$element.off("click","[data-"+r+"-next]").on("click","[data-"+r+"-next]",function(e){o.next(e)}),o.$navigate.off("click","."+r+"-navigate-prev").on("click","."+r+"-navigate-prev",function(e){o.prev(e)}),o.$element.off("click","[data-"+r+"-prev]").on("click","[data-"+r+"-prev]",function(e){o.prev(e)})}var o=this;if(this.state==s.CLOSED){if(i(),this.setGroup(),this.state=s.OPENING,this.$element.trigger(s.OPENING),this.$element.attr("aria-hidden","false"),this.options.iframe===!0){this.$element.find("."+r+"-content").addClass(r+"-content-loader"),this.$element.find("."+r+"-iframe").on("load",function(){e(this).parent().removeClass(r+"-content-loader")});var p=null;try{p=""!==e(n.currentTarget).attr("href")?e(n.currentTarget).attr("href"):null}catch(c){}if(null===this.options.iframeURL||null!==p&&void 0!==p||(p=this.options.iframeURL),null===p||void 0===p)throw new Error("Failed to find iframe URL");this.$element.find("."+r+"-iframe").attr("src",p)}(this.options.bodyOverflow||d)&&(e("html").addClass(r+"-isOverflow"),d&&e("body").css("overflow","hidden")),this.options.onOpening&&"function"==typeof this.options.onOpening&&this.options.onOpening(this),function(){if(o.group.ids.length>1){o.$navigate.appendTo("body"),o.$navigate.addClass(o.options.transitionInOverlay),o.options.navigateCaption===!0&&o.$navigate.find("."+r+"-navigate-caption").show();var i=o.$element.outerWidth();o.options.navigateArrows!==!1?"closeScreenEdge"===o.options.navigateArrows?(o.$navigate.find("."+r+"-navigate-prev").css("left",0).show(),o.$navigate.find("."+r+"-navigate-next").css("right",0).show()):(o.$navigate.find("."+r+"-navigate-prev").css("margin-left",-(i/2+84)).show(),o.$navigate.find("."+r+"-navigate-next").css("margin-right",-(i/2+84)).show()):(o.$navigate.find("."+r+"-navigate-prev").hide(),o.$navigate.find("."+r+"-navigate-next").hide());var a;0===o.group.index&&(a=e("."+r+"[data-"+r+'-group="'+o.group.name+'"][data-'+r+"-loop]").length,0===a&&o.options.loop===!1&&o.$navigate.find("."+r+"-navigate-prev").hide()),o.group.index+1===o.group.ids.length&&(a=e("."+r+"[data-"+r+'-group="'+o.group.name+'"][data-'+r+"-loop]").length,0===a&&o.options.loop===!1&&o.$navigate.find("."+r+"-navigate-next").hide())}o.options.overlay===!0?o.$overlay.appendTo("body"):e(o.options.overlay).length>0&&o.$overlay.appendTo(e(o.options.overlay)),o.options.transitionInOverlay&&o.$overlay.addClass(o.options.transitionInOverlay);var s=o.options.transitionIn;"object"==typeof n&&(void 0===n.transition&&void 0===n.transitionIn||(s=n.transition||n.transitionIn)),""!==s?(o.$element.addClass("transitionIn "+s).show(),o.$wrap.one(l,function(){o.$element.removeClass(s+" transitionIn"),o.$overlay.removeClass(o.options.transitionInOverlay),o.$navigate.removeClass(o.options.transitionInOverlay),t()})):(o.$element.show(),t()),o.options.pauseOnHover!==!0||o.options.pauseOnHover!==!0||o.options.timeout===!1||isNaN(parseInt(o.options.timeout))||o.options.timeout===!1||0===o.options.timeout||(o.$element.off("mouseenter").on("mouseenter",function(e){e.preventDefault(),o.isPaused=!0}),o.$element.off("mouseleave").on("mouseleave",function(e){e.preventDefault(),o.isPaused=!1}))}(),this.options.timeout===!1||isNaN(parseInt(this.options.timeout))||this.options.timeout===!1||0===this.options.timeout||(this.options.timeoutProgressbar===!0?(this.progressBar={hideEta:null,maxHideTime:null,currentTime:(new Date).getTime(),el:this.$element.find("."+r+"-progressbar > div"),updateProgress:function(){if(!o.isPaused){o.progressBar.currentTime=o.progressBar.currentTime+10;var e=(o.progressBar.hideEta-o.progressBar.currentTime)/o.progressBar.maxHideTime*100;o.progressBar.el.width(e+"%"),e<0&&o.close()}}},this.options.timeout>0&&(this.progressBar.maxHideTime=parseFloat(this.options.timeout),this.progressBar.hideEta=(new Date).getTime()+this.progressBar.maxHideTime,this.timerTimeout=setInterval(this.progressBar.updateProgress,10))):this.timerTimeout=setTimeout(function(){o.close()},o.options.timeout)),this.options.overlayClose&&!this.$element.hasClass(this.options.transitionOut)&&this.$overlay.click(function(){o.close()}),this.options.focusInput&&this.$element.find(":input:not(button):enabled:visible:first").focus(),function u(){o.recalcLayout(),o.timer=setTimeout(u,100)}(),function(){if(o.options.history){var e=document.title;document.title=e+" - "+o.options.title,document.location.hash=o.id,document.title=e}}(),a.on("keydown."+r,function(e){o.options.closeOnEscape&&27===e.keyCode&&o.close()})}},close:function(n){function t(){i.state=s.CLOSED,i.$element.trigger(s.CLOSED),i.options.iframe===!0&&i.$element.find("."+r+"-iframe").attr("src",""),(i.options.bodyOverflow||d)&&(e("html").removeClass(r+"-isOverflow"),d&&e("body").css("overflow","auto")),i.options.onClosed&&"function"==typeof i.options.onClosed&&i.options.onClosed(i),i.options.restoreDefaultContent===!0&&i.$element.find("."+r+"-content").html(i.content),0===e("."+r+":visible").length&&e("html").removeClass(r+"-isAttached")}var i=this;if(this.state==s.OPENED||this.state==s.OPENING){a.off("keydown."+r),this.state=s.CLOSING,this.$element.trigger(s.CLOSING),this.$element.attr("aria-hidden","true"),clearTimeout(this.timer),clearTimeout(this.timerTimeout),i.options.onClosing&&"function"==typeof i.options.onClosing&&i.options.onClosing(this);var o=this.options.transitionOut;"object"==typeof n&&(void 0===n.transition&&void 0===n.transitionOut||(o=n.transition||n.transitionOut)),""!==o?(this.$element.attr("class",[this.classes,r,o,"light"==this.options.theme?r+"-light":this.options.theme,this.isFullscreen===!0?"isFullscreen":"",this.options.rtl?r+"-rtl":""].join(" ")),this.$overlay.attr("class",r+"-overlay "+this.options.transitionOutOverlay),i.options.navigateArrows!==!1&&this.$navigate.attr("class",r+"-navigate "+this.options.transitionOutOverlay),this.$element.one(l,function(){i.$element.hasClass(o)&&i.$element.removeClass(o+" transitionOut").hide(),i.$overlay.removeClass(i.options.transitionOutOverlay).remove(),i.$navigate.removeClass(i.options.transitionOutOverlay).remove(),t()})):(this.$element.hide(),this.$overlay.remove(),this.$navigate.remove(),t())}},next:function(n){var t=this,i="fadeInRight",o="fadeOutLeft",a=e("."+r+":visible"),s={};s.out=this,void 0!==n&&"object"!=typeof n?(n.preventDefault(),a=e(n.currentTarget),i=a.attr("data-"+r+"-transitionIn"),o=a.attr("data-"+r+"-transitionOut")):void 0!==n&&(void 0!==n.transitionIn&&(i=n.transitionIn),void 0!==n.transitionOut&&(o=n.transitionOut)),this.close({transition:o}),setTimeout(function(){for(var n=e("."+r+"[data-"+r+'-group="'+t.group.name+'"][data-'+r+"-loop]").length,o=t.group.index+1;o<=t.group.ids.length;o++){try{s["in"]=e("#"+t.group.ids[o]).data().iziModal}catch(a){}if("undefined"!=typeof s["in"]){e("#"+t.group.ids[o]).iziModal("open",{transition:i});break}if(o==t.group.ids.length&&n>0||t.options.loop===!0)for(var l=0;l<=t.group.ids.length;l++)if(s["in"]=e("#"+t.group.ids[l]).data().iziModal,"undefined"!=typeof s["in"]){e("#"+t.group.ids[l]).iziModal("open",{transition:i});break}}},200),e(document).trigger(r+"-group-change",s)},prev:function(n){var t=this,i="fadeInLeft",o="fadeOutRight",a=e("."+r+":visible"),s={};s.out=this,void 0!==n&&"object"!=typeof n?(n.preventDefault(),a=e(n.currentTarget),i=a.attr("data-"+r+"-transitionIn"),o=a.attr("data-"+r+"-transitionOut")):void 0!==n&&(void 0!==n.transitionIn&&(i=n.transitionIn),void 0!==n.transitionOut&&(o=n.transitionOut)),this.close({transition:o}),setTimeout(function(){for(var n=e("."+r+"[data-"+r+'-group="'+t.group.name+'"][data-'+r+"-loop]").length,o=t.group.index;o>=0;o--){try{s["in"]=e("#"+t.group.ids[o-1]).data().iziModal}catch(a){}if("undefined"!=typeof s["in"]){e("#"+t.group.ids[o-1]).iziModal("open",{transition:i});break}if(0===o&&n>0||t.options.loop===!0)for(var l=t.group.ids.length-1;l>=0;l--)if(s["in"]=e("#"+t.group.ids[l]).data().iziModal,"undefined"!=typeof s["in"]){e("#"+t.group.ids[l]).iziModal("open",{transition:i});break}}},200),e(document).trigger(r+"-group-change",s)},destroy:function(){var n=e.Event("destroy");this.$element.trigger(n),a.off("keydown."+r),clearTimeout(this.timer),clearTimeout(this.timerTimeout),this.options.iframe===!0&&this.$element.find("."+r+"-iframe").remove(),this.$element.html(this.$element.find("."+r+"-content").html()),this.$element.off("click","[data-"+r+"-close]"),this.$element.off("click","[data-"+r+"-fullscreen]"),this.$element.off("."+r).removeData(r).attr("style",""),this.$overlay.remove(),this.$navigate.remove(),this.$element.trigger(s.DESTROYED),this.$element=null},getState:function(){return this.state},getGroup:function(){return this.group},setWidth:function(e){this.options.width=e,this.recalcWidth();var n=this.$element.outerWidth();this.options.navigateArrows!==!0&&"closeToModal"!=this.options.navigateArrows||(this.$navigate.find("."+r+"-navigate-prev").css("margin-left",-(n/2+84)).show(),this.$navigate.find("."+r+"-navigate-next").css("margin-right",-(n/2+84)).show());
},setTop:function(e){this.options.top=e,this.recalcVerticalPos(!1)},setBottom:function(e){this.options.bottom=e,this.recalcVerticalPos(!1)},setHeader:function(e){e?this.$element.find("."+r+"-header").show():(this.headerHeight=0,this.$element.find("."+r+"-header").hide())},setTitle:function(e){this.options.title=e,0===this.headerHeight&&this.createHeader(),0===this.$header.find("."+r+"-header-title").length&&this.$header.append('<h2 class="'+r+'-header-title"></h2>'),this.$header.find("."+r+"-header-title").html(e)},setSubtitle:function(e){""===e?(this.$header.find("."+r+"-header-subtitle").remove(),this.$header.addClass(r+"-noSubtitle")):(0===this.$header.find("."+r+"-header-subtitle").length&&this.$header.append('<p class="'+r+'-header-subtitle"></p>'),this.$header.removeClass(r+"-noSubtitle")),this.$header.find("."+r+"-header-subtitle").html(e),this.options.subtitle=e},setIcon:function(e){0===this.$header.find("."+r+"-header-icon").length&&this.$header.prepend('<i class="'+r+'-header-icon"></i>'),this.$header.find("."+r+"-header-icon").attr("class",r+"-header-icon "+e),this.options.icon=e},setIconText:function(e){this.$header.find("."+r+"-header-icon").html(e),this.options.iconText=e},setHeaderColor:function(e){this.options.borderBottom===!0&&this.$element.css("border-bottom","3px solid "+e),this.$header.css("background",e),this.options.headerColor=e},setZindex:function(e){isNaN(parseInt(this.options.zindex))||(this.options.zindex=e,this.$element.css("z-index",e),this.$navigate.css("z-index",e-1),this.$overlay.css("z-index",e-2))},setFullscreen:function(e){e?(this.isFullscreen=!0,this.$element.addClass("isFullscreen")):(this.isFullscreen=!1,this.$element.removeClass("isFullscreen"))},setTransitionIn:function(e){this.options.transitionIn=e},setTransitionOut:function(e){this.options.transitionOut=e},startLoading:function(){this.$element.find("."+r+"-loader").length||this.$element.append('<div class="'+r+'-loader fadeIn"></div>'),this.$element.find("."+r+"-loader").css({top:this.headerHeight,borderRadius:this.options.radius})},stopLoading:function(){var e=this.$element.find("."+r+"-loader");e.length||(this.$element.prepend('<div class="'+r+'-loader fadeIn"></div>'),e=this.$element.find("."+r+"-loader").css("border-radius",this.options.radius)),e.removeClass("fadeIn").addClass("fadeOut"),setTimeout(function(){e.remove()},600)},recalcWidth:function(){var e=this;if(this.$element.css("max-width",this.options.width),t()){var n=e.options.width;n.toString().split("%").length>1&&(n=e.$element.outerWidth()),e.$element.css({left:"50%",marginLeft:-(n/2)})}},recalcVerticalPos:function(e){null!==this.options.top&&this.options.top!==!1?(this.$element.css("margin-top",this.options.top),0===this.options.top&&this.$element.css({borderTopRightRadius:0,borderTopLeftRadius:0})):e===!1&&this.$element.css({marginTop:"",borderRadius:this.options.radius}),null!==this.options.bottom&&this.options.bottom!==!1?(this.$element.css("margin-bottom",this.options.bottom),0===this.options.bottom&&this.$element.css({borderBottomRightRadius:0,borderBottomLeftRadius:0})):e===!1&&this.$element.css({marginBottom:"",borderRadius:this.options.radius})},recalcLayout:function(){var n=this,a=o.height(),l=this.$element.outerHeight(),d=this.$element.outerWidth(),p=this.$element.find("."+r+"-content")[0].scrollHeight,c=p+this.headerHeight,u=this.$element.innerHeight()-this.headerHeight,m=(parseInt(-((this.$element.innerHeight()+1)/2))+"px",this.$wrap.scrollTop()),h=0;t()&&(d>=o.width()||this.isFullscreen===!0?this.$element.css({left:"",marginLeft:""}):this.$element.css({left:"50%",marginLeft:-(d/2)})),this.options.borderBottom===!0&&""!==this.options.title&&(h=3),this.$element.find("."+r+"-header").length&&this.$element.find("."+r+"-header").is(":visible")?(this.headerHeight=parseInt(this.$element.find("."+r+"-header").innerHeight()),this.$element.css("overflow","hidden")):(this.headerHeight=0,this.$element.css("overflow","")),this.$element.find("."+r+"-loader").length&&this.$element.find("."+r+"-loader").css("top",this.headerHeight),l!==this.modalHeight&&(this.modalHeight=l,this.options.onResize&&"function"==typeof this.options.onResize&&this.options.onResize(this)),this.state!=s.OPENED&&this.state!=s.OPENING||(this.options.iframe===!0&&(a<this.options.iframeHeight+this.headerHeight+h||this.isFullscreen===!0?this.$element.find("."+r+"-iframe").css("height",a-(this.headerHeight+h)):this.$element.find("."+r+"-iframe").css("height",this.options.iframeHeight)),l==a?this.$element.addClass("isAttached"):this.$element.removeClass("isAttached"),this.isFullscreen===!1&&this.$element.width()>=o.width()?this.$element.find("."+r+"-button-fullscreen").hide():this.$element.find("."+r+"-button-fullscreen").show(),this.recalcButtons(),this.isFullscreen===!1&&(a=a-(i(this.options.top)||0)-(i(this.options.bottom)||0)),c>a?(this.options.top>0&&null===this.options.bottom&&p<o.height()&&this.$element.addClass("isAttachedBottom"),this.options.bottom>0&&null===this.options.top&&p<o.height()&&this.$element.addClass("isAttachedTop"),e("html").addClass(r+"-isAttached"),this.$element.css("height",a)):(this.$element.css("height",p+(this.headerHeight+h)),this.$element.removeClass("isAttachedTop isAttachedBottom"),e("html").removeClass(r+"-isAttached")),function(){p>u&&c>a?(n.$element.addClass("hasScroll"),n.$wrap.css("height",l-(n.headerHeight+h))):(n.$element.removeClass("hasScroll"),n.$wrap.css("height","auto"))}(),function(){u+m<p-30?n.$element.addClass("hasShadow"):n.$element.removeClass("hasShadow")}())},recalcButtons:function(){var e=this.$header.find("."+r+"-header-buttons").innerWidth()+10;this.options.rtl===!0?this.$header.css("padding-left",e):this.$header.css("padding-right",e)}},o.off("hashchange."+r+" load."+r).on("hashchange."+r+" load."+r,function(n){var t=document.location.hash;if(0===p)if(""!==t){e.each(e("."+r),function(n,i){var o=e(i).iziModal("getState");"opened"!=o&&"opening"!=o||"#"+e(i)[0].id!==t&&e(i).iziModal("close")});try{var i=e(t).data();"undefined"!=typeof i&&("load"===n.type?i.iziModal.options.autoOpen!==!1&&e(t).iziModal("open"):setTimeout(function(){e(t).iziModal("open")},200))}catch(o){}}else e.each(e("."+r),function(n,t){if(void 0!==e(t).data().iziModal){var i=e(t).iziModal("getState");"opened"!=i&&"opening"!=i||e(t).iziModal("close")}});else p=0}),a.off("click","[data-"+r+"-open]").on("click","[data-"+r+"-open]",function(n){n.preventDefault();var t=e("."+r+":visible"),i=e(n.currentTarget).attr("data-"+r+"-open"),o=e(n.currentTarget).attr("data-"+r+"-transitionIn"),a=e(n.currentTarget).attr("data-"+r+"-transitionOut");void 0!==a?t.iziModal("close",{transition:a}):t.iziModal("close"),setTimeout(function(){void 0!==o?e(i).iziModal("open",{transition:o}):e(i).iziModal("open")},200)}),a.off("keyup."+r).on("keyup."+r,function(n){if(e("."+r+":visible").length){var t=e("."+r+":visible")[0].id,i=e("#"+t).iziModal("getGroup"),o=n||window.event,a=o.target||o.srcElement;void 0===t||void 0===i.name||o.ctrlKey||o.metaKey||o.altKey||"INPUT"===a.tagName.toUpperCase()||"TEXTAREA"==a.tagName.toUpperCase()||(37===o.keyCode?e("#"+t).iziModal("prev",o):39===o.keyCode&&e("#"+t).iziModal("next",o))}}),e.fn[r]=function(n,t){if(!e(this).length&&"object"==typeof n){var i={$el:document.createElement("div"),id:this.selector.split("#"),"class":this.selector.split(".")};if(i.id.length>1){try{i.$el=document.createElement(id[0])}catch(o){}i.$el.id=this.selector.split("#")[1].trim()}else if(i["class"].length>1){try{i.$el=document.createElement(i["class"][0])}catch(o){}for(var a=1;a<i["class"].length;a++)i.$el.classList.add(i["class"][a].trim())}document.body.appendChild(i.$el),this.push(e(this.selector))}for(var s=this,l=0;l<s.length;l++){var d=e(s[l]),u=d.data(r),m=e.extend({},e.fn[r].defaults,d.data(),"object"==typeof n&&n);if(u||n&&"object"!=typeof n){if("string"==typeof n&&"undefined"!=typeof u)return u[n].apply(u,[].concat(t))}else d.data(r,u=new c(d,m));m.autoOpen&&(isNaN(parseInt(m.autoOpen))?m.autoOpen===!0&&u.open():setTimeout(function(){u.open()},m.autoOpen),p++)}return this},e.fn[r].defaults={title:"",subtitle:"",headerColor:"#88A0B9",theme:"",appendTo:".body",icon:null,iconText:null,iconColor:"",rtl:!1,width:600,top:null,bottom:null,borderBottom:!0,padding:0,radius:3,zindex:999,iframe:!1,iframeHeight:400,iframeURL:null,focusInput:!0,group:"",loop:!1,navigateCaption:!0,navigateArrows:!0,history:!1,restoreDefaultContent:!1,autoOpen:0,bodyOverflow:!1,fullscreen:!1,openFullscreen:!1,closeOnEscape:!0,closeButton:!0,overlay:!0,overlayClose:!0,overlayColor:"rgba(0, 0, 0, 0.4)",timeout:!1,timeoutProgressbar:!1,pauseOnHover:!1,timeoutProgressbarColor:"rgba(255,255,255,0.5)",transitionIn:"comingIn",transitionOut:"comingOut",transitionInOverlay:"fadeIn",transitionOutOverlay:"fadeOut",onFullscreen:function(){},onResize:function(){},onOpening:function(){},onOpened:function(){},onClosing:function(){},onClosed:function(){}},e.fn[r].Constructor=c,e.fn.iziModal});var validators={required:function(e,n){var t=e.val();if("radio"===e.attr("type")&&(t=$("input:radio[name="+e.attr("name")+"]").filter(":checked").val()),""===t||void 0===t)return{hasError:!0,message:n}},civicnumber:function(e,n){if(e.val(e.val().replace(/\D/g,"")),!/^\d{12}$/.test(e.val()))return{hasError:!0,message:n}},max:function(e,n){var t=n.split(",")[0],i=n.split(",")[1];if(value=e.val().replace(/[^\d]/g,"").replace(/[.-]/g,""),Number(value)>Number(t))return{hasError:!0,message:i}},maxmoney:function(e,n){},min:function(e,n){var t=n.split(",")[0],i=n.split(",")[1],o=e.val().replace(/[^\d-]/g,"");if(Number(o)<Number(t))return{hasError:!0,message:i}},email:function(e,n){var t=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;if(!t.test(e.val()))return{hasError:!0,message:n}},bankaccount:function(e,n){var t=/^\d{1,11}\-[\dxX]{1,2}$/;if(!t.test(e.val()))return{hasError:!0,message:n}},cep:function(e,n){var t=/^\d{8}$/;if(!t.test(e.val()))return{hasError:!0,message:n}},cpf:function(e,n){var t=/^\d\d\d[.]?\d\d\d[.]?\d\d\d[-]?\d\d$/;if(!t.test(e.val()))return{hasError:!0,message:n};var i,o,a,r,s,l,d,p=e.val().replace(/\D/g,"");for(d=!1,l=1,r=0;r<p.length-1;r++)if(p.charAt(r)!=p.charAt(r+1)){l=0;break}for(l&&(d=!0),i=p.slice(0,9),o=p.slice(9),a=0,r=10;r>1;r--)a+=i.charAt(10-r)*r;for(s=a%11<2?0:11-a%11,s!=o.charAt(0)&&(d=!0),i=p.slice(0,10),a=0,r=11;r>1;r--)a+=i.charAt(11-r)*r;return s=a%11<2?0:11-a%11,s!=o.charAt(1)&&(d=!0),d?{hasError:!0,message:n}:void 0},telephone:function(e,n){e.val(e.val().replace(/\D/g,""));var t=/^\d{11,}$/;if(!t.test(e.val()))return{hasError:!0,message:n}},number:function(e,n){if(!/^\d+$/.test(e.val()))return{hasError:!0,message:n}}},VIACep={lookupCEP:function(e,n){if("string"!=typeof e)return void n("CEP not a string");e=e.replace(/\D/g,"");var t=/^\d{8}$/;if(t.test(e)!==!0)return void n("Invalid CEP");var i="https://viacep.com.br/ws/"+e+"/json/?callback=?",o=null,a=null;$.getJSON(i,function(e,n){o=e}).fail(function(e,n,t){a=t}).always(function(){o=o||{},n(a,{neighbourhood:o.bairro,city:o.localidade,street:o.logradouro,complement:o.complemento,state:o.uf})})}};ns("lending.components").applicationComplete=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.revision=n.$el.find('[name="_revision"]').val(),n.$zipcodeInput=n.$el.find('[name="zipCode"]'),n.$cityInput=n.$el.find('[name="city"]'),n.$address1Input=n.$el.find('[name="address1"]'),n.$address2Input=n.$el.find('[name="address2"]'),n.$stateSelect=n.$el.find('[name="state"]'),n.$neighbourhoodInput=n.$el.find('[name="neighbourhood"]'),n.$companyZipcodeInput=n.$el.find('[name="companyZipCode"]'),n.$companyCityInput=n.$el.find('[name="companyCity"]'),n.$companyAddressInput=n.$el.find('[name="companyAddress"]'),n.$compantAddressComplementInput=n.$el.find('[name="companyAddressComplement"]'),n.$companyStateSelect=n.$el.find('[name="companyState"]'),n.$companyNeighbourhoodInput=n.$el.find('[name="companyNeighbourhood"]'),n.$bankName=n.$el.find('[name="bankName"]'),n.$hasCreditRestrictions=n.$el.find('input[name="hasCreditRestrictions"]'),n.updateBankName=function(e){var t=n.$bankName.val();""===t||"no"==t?n.$el.find(".has-bank-details").hide():n.$el.find(".has-bank-details").show()},n.$bankName.on("change",n.updateBankName),n.updateBankName(),n.lookupCEP=function(e){VIACep.lookupCEP(e,function(e,t){e||(n.$cityInput.val(t.city),n.$address1Input.val(t.street),n.$stateSelect.val(t.state),n.$neighbourhoodInput.val(t.neighbourhood))})},""!=n.$zipcodeInput.val()&&n.lookupCEP(n.$zipcodeInput.val()),n.$zipcodeInput.on("blur",function(){n.lookupCEP(n.$zipcodeInput.val()),n.temporaryPersist()}),n.lookupCEPCompany=function(e){VIACep.lookupCEP(e,function(e,t){e||(n.$companyCityInput.val(t.city),n.$companyAddressInput.val(t.street),n.$companyStateSelect.val(t.state),n.$companyNeighbourhoodInput.val(t.neighbourhood))})},n.$companyZipcodeInput.on("blur",function(){n.lookupCEPCompany(n.$companyZipcodeInput.val()),n.temporaryPersist()}),n.$el.on("submit",function(e){return e.preventDefault(),validateForm(n.$el)?(n.$el.find(".errors").hide(),void n.persistChanges(!0,function(){window.app.router.routeTo("/me/applications/"+n.applicationId)})):void n.$el.find(".errors").show()}),n.persistChanges=function(e,t){window.app.api.applications.findFromId(n.applicationId,function(i,o){var a=gatherApplicationFormData(n.$el);for(var r in a)o[r]=a[r];"no"!=a.bankName&&""!=a.bankName||(o.bankName="",o.accountType=null),"married"===o.civilStatus&&(o.hasCoApplicant=!0),o.hasDriversLicence="true"===a.hasDriversLicence,null!=o.hasCreditRestrictions&&(o.hasCreditRestrictions="true"===a.hasCreditRestrictions),a.vehicleSecurity&&(o.vehicleSecurity.hasExistingLoans="on"===a.vehicleSecurity.hasExistingLoans),window.app.api.applications.update(n.applicationId,o,function(i,o){i?console.warn("update ERROR:",i):(n.revision=o.revision,e&&window.app.api.applications.completedApplication(o.id,{revision:n.revision},function(e,i){n.revision=i.revision,t&&"function"==typeof t&&t(i)}))})})},n.temporaryPersist=function(){n.persistChanges(!1)},n.$el.find("input, select").on("change",n.temporaryPersist),n},registerComponent(".application-complete",lending.components.applicationComplete),registerComponent(".application-complete-he",lending.components.applicationComplete),ns("lending.components").applicationCompleteCP=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.revision=n.$el.find('[name="_revision"]').val(),n.$zipcodeInput=n.$el.find('[name="zipCode"]'),n.$cityInput=n.$el.find('[name="city"]'),n.$address1Input=n.$el.find('[name="address1"]'),n.$address2Input=n.$el.find('[name="address2"]'),n.$stateSelect=n.$el.find('[name="state"]'),n.$neighbourhoodInput=n.$el.find('[name="neighbourhood"]'),n.$streetNumber=n.$el.find('[name="streetNumber"]'),n.$bankName=n.$el.find('[name="bankName"]'),n.$hasCreditRestrictions=n.$el.find('input[name="hasCreditRestrictions"]'),n.$companyZipcodeInput=n.$el.find('[name="companyZipCode"]'),n.$companyCityInput=n.$el.find('[name="companyCity"]'),n.$companyAddressInput=n.$el.find('[name="companyAddress"]'),n.$compantAddressComplementInput=n.$el.find('[name="companyAddressComplement"]'),n.$companyStateSelect=n.$el.find('[name="companyState"]'),n.$companyNeighbourhoodInput=n.$el.find('[name="companyNeighbourhood"]'),n.updateFormCreditRestrictions=function(){var e=n.$el.find('input[name="hasCreditRestrictions"]:checked').val(),t=(n.$el.find(".co-applicant-section"),n.$el.find(".bank-details-section"),n.$el.find(".car-security-section"));if(void 0!=e||t.length>0){var i=n.$el.find(".income-section"),o=n.$el.find(".address-section");t.show(),o.show(),i.show()}if(void 0!=e){var a=n.$el.find(".restriction-disclaimer");a.hide()}},n.updateCreditRestriction=function(e){n.updateFormCreditRestrictions()},n.$hasCreditRestrictions.on("change",n.updateCreditRestriction),n.updateFormCreditRestrictions(),n.updateBankName=function(e){var t=n.$bankName.val();""===t||"no"==t?n.$el.find(".has-bank-details").hide():n.$el.find(".has-bank-details").show()},n.$bankName.on("change",n.updateBankName),n.updateBankName(),n.lookupCEP=function(e){VIACep.lookupCEP(e,function(e,t){e||(n.$cityInput.val(t.city),n.$address1Input.val(t.street),n.$stateSelect.val(t.state),n.$neighbourhoodInput.val(t.neighbourhood))})},""!=n.$zipcodeInput.val()&&n.lookupCEP(n.$zipcodeInput.val()),n.$zipcodeInput.on("blur",function(){n.lookupCEP(n.$zipcodeInput.val()),n.temporaryPersist()}),n.lookupCEPCompany=function(e){VIACep.lookupCEP(e,function(e,t){e||(n.$companyCityInput.val(t.city),n.$companyAddressInput.val(t.street),n.$companyStateSelect.val(t.state),n.$companyNeighbourhoodInput.val(t.neighbourhood))})},n.$companyZipcodeInput.on("blur",function(){n.lookupCEPCompany(n.$companyZipcodeInput.val()),n.temporaryPersist()}),n.$el.on("submit",function(e){return e.preventDefault(),validateForm(n.$el)?(n.$el.find(".errors").hide(),void n.persistChanges(!0,function(){window.app.router.routeTo("/me/applications/"+n.applicationId)})):void n.$el.find(".errors").show()}),n.persistChanges=function(e,t){window.app.api.applications.findFromId(n.applicationId,function(i,o){var a=gatherApplicationFormData(n.$el);for(var r in a)o[r]=a[r];"no"!=a.bankName&&""!=a.bankName||(o.bankName="",o.accountType=null),"married"===o.civilStatus&&(o.hasCoApplicant=!0),o.hasDriversLicence="true"===a.hasDriversLicence,o.hasCreditRestrictions="true"===a.hasCreditRestrictions,a.vehicleSecurity&&(o.vehicleSecurity.hasExistingLoans="on"===a.vehicleSecurity.hasExistingLoans),window.app.api.applications.update(n.applicationId,o,function(i,o){i?console.warn("update ERROR:",i):(n.revision=o.revision,e&&window.app.api.applications.completedApplication(o.id,{revision:n.revision},function(e,i){n.revision=i.revision,t&&"function"==typeof t&&t(i)}))})})},n.temporaryPersist=function(){n.persistChanges(!1)},n.$el.find("input, select").on("change",n.temporaryPersist),n},registerComponent(".application-complete-cp",lending.components.applicationCompleteCP),ns("lending.components").applicationFileDropZone=function(e){var n=this;n.$el=e,n.applicationId=n.$el.data("application-id"),n.$uploading=n.$el.find(".uploading"),n.$done=n.$el.find(".done"),n.$validator=n.$el.siblings(".validator").first(),n.fileCategory=n.$el.data("file-category");var t=location.protocol,i=t.concat("//"),o=i.concat(window.location.hostname)+"/api";"localhost"===window.location.hostname&&(o="http://localhost:4000");var a=o+"/applications/"+n.applicationId+"/files/"+n.fileCategory,r=new Dropzone("#"+n.$el.attr("id"),{headers:{Authorization:window.app.getAuth()},url:a,method:"post",paramName:"file",uploadMultiple:!1});return r.on("uploadprogress",function(){n.$el.find(".dz-default").hide(),n.$uploading.show()}),r.on("complete",function(){n.$validator.val("ok"),n.$validator.change(),n.$uploading.hide(),n.$done.show(),n.$el.addClass("complete"),n.$el.find(".dz-default").hide()}),n},registerComponent(".application-file-dropzone",lending.components.applicationFileDropZone),ns("lending.components").applicationForm=function(e){var n=this;$(".modal-alert").iziModal({title:"CPF informado já cadastrado.",subtitle:"A página será redirecionada",headerColor:"#43B69A"}),n.$el=e,n.$errorContainer=n.$el.find(".errors"),n.$valuesSection=n.$el.find(".values-section"),n.$downpaymentContainer=n.$el.find(".downpayment-container"),n.$appliedAmountContainer=n.$el.find(".applied-amount-container"),n.$appliedAmountValue=n.$el.find(".applied-amount-value"),n.$securityValueContainer=n.$el.find(".security-value-container"),n.$securityValue=n.$el.find(".security-value"),n.$vehiclesecurityDownpaymentValue=n.$el.find(".vehiclesecurity-downpayment"),n.$noSecuritySection=n.$el.find(".no-security"),n.$securityIsOwnedSelector=n.$el.find('input[name="securityIsOwned"]'),n.$securityTypeSelector=n.$el.find('input[name="securityType"]'),n.$loanText=n.$el.find(".loan-text"),n.$financeText=n.$el.find(".finance-text"),n.$loanPeriod=n.$el.find(".loan-period"),n.$loanPeriodOptions=n.$el.find('[name="loanPeriodInMonths"]'),n.$telephoneSection=n.$el.find(".telephone-section"),n.$telephoneColumn=n.$telephoneSection.find(".telephone-column"),n.$homePhoneColumn=n.$telephoneSection.find(".home-phone-column"),n.$hasPreselection="true"===n.$el.find('[name="has-preselection"]').val(),n.$cpfUser=n.$el.find('input[name="personalNumber"]'),n.$cpfUser.on("change",function(){validateForm(n.$el,"personalNumber")?($("#check-personalNumber").css("display","none"),personalNumber=n.$cpfUser.val().replace(".","").replace(".","").replace("-",""),window.app.api.applications.findCpf(personalNumber,function(e,t){e?$("#check-personalNumber").css("display","block"):(n.$el.find('input[name="personalNumber"]').val(null),$("#check-personalNumber").css("display","none"),$(".modal-alert").iziModal("open"))}),$("#ok-alert-modal").on("click",function(){$(".modal-alert").iziModal("close"),window.app.api.auth.requestCode("",personalNumber,function(e,n){e?console.log(e):window.app.router.routeTo("/login?key="+n.key)})})):$("#check-personalNumber").css("display","none")}),n.previousApplication=null;var t=n.$el.find('[name="previous-application-id"]').val();return""!=t&&window.app.api.applications.findFromId(t,function(e,t){return e?void console.log(e):void(n.previousApplication=t)}),n.$productSelectionSection=n.$el.find(".product-selection"),n.$hasPreselection?n.$productSelectionSection.hide():n.$productSelectionSection.show(),n.updatePeriodOptions=function(e){var t={ranges:{Selecionar:"","06 a 12 meses":6,"12 a 18 meses":12,"18 a 24 meses":18,"24 a 36 meses":24,"36 a 48 meses":36,"48 a 60 meses":48},months:{Selecionar:"","06 meses":6,"12 meses":12,"18 meses":18,"24 meses":24,"30 meses":30,"36 meses":36},years:{Selecionar:"","3 anos":36,"4 anos":48,"5 anos":60,"10 anos":120,"15 anos":180}};n.$loanPeriodOptions.empty(),$.each(t[e],function(e,t){n.$loanPeriodOptions.append($("<option></option>").attr("value",t).text(e))})},n.updateValuesState=function(){var e=n.getSelectedSecurityType(),t=n.getSelectedSecurityIsOwned(),i=function(e,t,i){e.detach(),t.detach(),i.detach(),n.$valuesSection.append(e),n.$valuesSection.append(t),n.$valuesSection.append(i)};if(null!==t&&"undefined"!=typeof t){n.$valuesSection.show(),n.$el.find(".interest-disclaimer").hide();var o=n.$el.find(".disclaimer-cp"),a=n.$el.find(".disclaimer-he"),r=n.$el.find(".disclaimer-refin");if(t===!0){if(n.$noSecuritySection.show(),"home"===e?a.show():"car"===e?r.show():o&&o.show(),null===e||"undefined"==typeof e)return n.$valuesSection.hide(),void n.$loanPeriod.hide();if(n.$valuesSection.show(),n.$loanPeriod.show(),n.$financeText.hide(),n.$loanText.show(),n.$downpaymentContainer.hide(),i(n.$securityValueContainer,n.$appliedAmountContainer,n.$downpaymentContainer),"car"===e){n.$valuesSection.addClass("two-col"),n.$appliedAmountContainer.show(),n.$securityValueContainer.show(),n.updatePeriodOptions("ranges");var s=function(){var e=Number(n.$securityValueSlider.noUiSlider.get()),t=.8*e;n.$appliedAmountValueSlider.noUiSlider.updateOptions({range:{min:1e3,max:t}}),n.$appliedAmountValueSlider.noUiSlider.set(t)};n.$securityValueSlider.noUiSlider.on("update",s)}else if("no-security"===e)n.updatePeriodOptions("months"),n.$appliedAmountValueSlider.noUiSlider.updateOptions({range:{min:1e3,max:35e3}}),n.$valuesSection.removeClass("two-col"),n.$appliedAmountContainer.show(),n.$securityValueContainer.hide();else if("home"===e){n.$valuesSection.addClass("two-col"),n.$appliedAmountContainer.show(),n.$securityValueContainer.show(),n.updatePeriodOptions("years");var s=function(){var e=4e4,t=Number(n.$securityValueSlider.noUiSlider.get()),i=.5*t;i<=e&&(i=e+1),n.$appliedAmountValueSlider.noUiSlider.updateOptions({range:{min:e,max:i}}),n.$appliedAmountValueSlider.noUiSlider.set(i)};n.$securityValueSlider.noUiSlider.on("update",s)}}else{n.updatePeriodOptions("ranges"),i(n.$securityValueContainer,n.$downpaymentContainer,n.$appliedAmountContainer),n.$valuesSection.addClass("two-col"),n.$noSecuritySection.hide(),n.$downpaymentContainer.show(),n.$securityValueContainer.show(),n.$appliedAmountContainer.hide();var s=function(){var e=n.$securityValueSlider.noUiSlider.get();n.$vehiclesecurityDownpaymentSlider.noUiSlider.updateOptions({range:{min:.2*e,max:.9*e}})};n.$securityValueSlider.noUiSlider.on("update",s),n.$loanPeriod.show(),n.$financeText.show(),n.$loanText.hide()}}},n.$securityTypeSelector.on("change",n.updateValuesState),n.$securityIsOwnedSelector.on("change",n.updateValuesState),n.getSelectedSecurityType=function(){return"true"===n.$el.find('input[name="home-equity"]').val()?"home":n.$el.find('input[name="securityType"]:checked').val()||"no-security"},n.getSelectedSecurityIsOwned=function(){var e=n.$el.find('input[name="securityIsOwned"]:checked');return 0!==e.length?"true"===e.val():null},n.bindSliderToPreview=function(e,n){var t=function(e,t){var i=e[t];n.html(numeral(i).format("$ 0,0"))};e.noUiSlider.on("update",t)},n.makeSlider=function(e){$container=n.$el.find(e)[0];var t={start:Number($container.getAttribute("data-start")),step:Number($container.getAttribute("data-step")),connect:"lower",range:{min:Number($container.getAttribute("data-range-min")),max:Number($container.getAttribute("data-range-max"))}};return noUiSlider.create($container,t),$container},n.submitForm=function(e){return e.preventDefault(),$(".modal-alert").iziModal("close"),validateForm(n.$el)?(n.$el.find(".errors").hide(),void(n.persisting||(sessionStorage.removeItem("formType"),n.persisting=!0,n.persistChanges(function(e,t){window.app.api.applications.postApplication(n.applicationId,{revision:t.revision},function(e,i){n.sendGoogleTagmanagerEvent(),e?"Email already used"===e.error?null==window.app.getCurrentUser()?(alert("Você já tem uma solicitação de financiamento. Por favor acesse seu formulário"),n.sendGoogleTagmanagerEvent(),window.app.router.routeTo("/login?return=/me&email="+encodeURIComponent(t.email))):(n.sendGoogleTagmanagerEvent(),window.app.clearCurrentApplication(),window.app.router.routeTo("/me/applications/"+t.id)):n.$errorContainer.html(e).show():(n.sendGoogleTagmanagerEvent(),window.app.clearCurrentApplication(),null===window.app.getAuth()&&(window.app.setAuth(i.token),window.app.setCurrentUser(i.user)),window.app.router.routeTo("/me/applications/"+t.id))})})))):void n.$el.find(".errors").show()},n.sendGoogleTagmanagerEvent=function(){if("undefined"!=typeof dataLayer&&null!==dataLayer){var e=n.getSelectedSecurityType(),t=n.getSelectedSecurityIsOwned(),i="";"car"===e?i=t?"EmprestimoGarantia":"Financiamento":"no-security"===e&&(i="Emprestimo"),dataLayer.push({event:"Leads",eventCategory:i})}},n.init=function(){n.initSliders(),n.bindSliders(),n.$el.on("submit",n.submitForm),n.updateValuesState()},n.initSliders=function(){n.$appliedAmountValueSlider=n.makeSlider(".applied-amount-input-slider"),n.$securityValueSlider=n.makeSlider(".security-value-slider"),n.$vehiclesecurityDownpaymentSlider=n.makeSlider(".vehiclesecurity-downpayment-slider")},n.bindSliders=function(){n.bindSliderToPreview(n.$appliedAmountValueSlider,n.$appliedAmountValue),n.bindSliderToPreview(n.$securityValueSlider,n.$securityValue),n.bindSliderToPreview(n.$vehiclesecurityDownpaymentSlider,n.$vehiclesecurityDownpaymentValue)},n.persistChanges=function(e){window.app.getCurrentApplication(function(t,i){n.revision=i.revision,n.applicationId=i.id;var i=gatherFormData(n.$el,{loanPeriodInMonths:Number,email:stringToLower});i.securityIsOwned=n.getSelectedSecurityIsOwned(),i.securityType=n.getSelectedSecurityType()||"car",i.appliedAmount=n.$appliedAmountValueSlider.noUiSlider.get(),i.securityIsOwned===!1&&(i.securityType="car"),i.loanPeriodInMonths=Number(i.loanPeriodInMonths),i.appliedAmount=Number(i.appliedAmount),"car"===i.securityType?(void 0!==i.vehicleSecurity&&null!==i.vehicleSecurity||(i.vehicleSecurity={}),i.vehicleSecurity.value=Number(n.$securityValueSlider.noUiSlider.get()),i.securityIsOwned?i.vehicleSecurity.downPayment=0:(i.appliedAmount=0,i.vehicleSecurity.downPayment=Number(n.$vehiclesecurityDownpaymentSlider.noUiSlider.get()))):i.vehicleSecurity=null,"home"===i.securityType?(void 0!==i.homeSecurity&&null!==i.homeSecurity||(i.homeSecurity={}),i.homeSecurity.value=Number(n.$securityValueSlider.noUiSlider.get())):i.homeSecurity=null,i.revision=n.revision,null!=n.previousApplication&&(i.RG=n.previousApplication.RG,i.RGExpeditorOrganisation=n.previousApplication.RGExpeditorOrganisation,i.RGExpeditionDate=n.previousApplication.RGExpeditionDate,i.placeOfBirth=n.previousApplication.placeOfBirth,i.nationality=n.previousApplication.nationality,i.fathersName=n.previousApplication.fathersName,i.mothersName=n.previousApplication.mothersName,i.zipCode=n.previousApplication.zipCode,i.streetNumber=n.previousApplication.streetNumber),window.app.api.applications.update(n.applicationId,i,function(t,i){n.revision=i.revision,e&&"function"==typeof e&&e(t,i)})})},n},registerComponent(".application-form",lending.components.applicationForm),ns("lending.components").applicationSimulateValues=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.revision=n.$el.find('[name="_revision"]').val(),n.$zipcodeInput=n.$el.find('[name="zipCode"]'),n.$stateSelect=n.$el.find('[name="state"]'),n.$hasCreditRestrictions=n.$el.find('input[name="hasCreditRestrictions"]'),n.$simulatedValue=n.$el.find(".simulated-value"),n.$simulatedSection=n.$el.find(".simulation-section"),n.$simulateButton=n.$el.find('[name="simulateNow"]'),n.$newSimulationButton=n.$el.find('[name="simulateAgain"]'),n.$simulationAcceptedButton=n.$el.find('[name="acceptSimulation"]'),n.$simulationrejectedButton=n.$el.find('[name="rejectSimulation"]'),n.$securitySubtype=n.$el.find('input[name="securitySubtype"]'),n.$modelYear=n.$el.find('[name="vehicleSecurity.modelYear"]'),n.$serverWait=n.$el.find(".server-wait"),n.$incomePaymentDay=n.$el.find('[name="incomePaymentDay option:selected"]'),n.$incomePaymentMethod=n.$el.find('[name="incomePaymentMethod option:selected"]'),n.$netWorth=n.$el.find('[name="netWorth option:selected"]'),n.simulated=!1,n.lookupCEP=function(e){VIACep.lookupCEP(e,function(e,t){e||(n.$stateSelect.val(t.state),n.$el.find('[name="city"]').val(t.city),n.$el.find('[name="address1"]').val(t.street),n.$el.find('[name="neighbourhood"]').val(t.neighbourhood))})},""!=n.$zipcodeInput.val()&&n.lookupCEP(n.$zipcodeInput.val()),n.$zipcodeInput.on("blur",function(){n.lookupCEP(n.$zipcodeInput.val()),n.persistChanges()}),n.$el.on("submit",function(e){return e.preventDefault(),validateForm(n.$el)?(n.$el.find(".errors").hide(),void n.persistChanges(function(){window.app.router.routeTo("/me/applications/"+n.applicationId)})):void n.$el.find(".errors").show()}),n.$newSimulationButton.on("click",function(e){e.preventDefault(),n.simulated=!1,n.$el.find(".alert-installment-too-high").hide(),n.$el.find(".simulated-value").hide(),n.$el.find(".simulation-rejected").hide(),n.$el.find(".simulating-buttons").show(),n.$el.find(".disable-simulated").find(":input").attr("disabled",null)}),n.$simulationAcceptedButton.on("click",function(e){return e.preventDefault(),validateForm(n.$el)?(n.$el.find(".errors").hide(),void window.app.api.applications.acceptsimulation(n.applicationId,{revision:n.revision},function(e,t){e?console.warn(e):n.revision=t.revision,window.location.reload()})):void n.$el.find(".errors").show()}),n.$securitySubtype.on("change, click",function(e){var t=n.$el.find("input[name=securitySubtype]:checked").val();"car"==t?n.$modelYear.trigger("listReload",{future:1,past:25}):n.$modelYear.trigger("listReload",{future:1,past:20})}),n.$simulationrejectedButton.on("click",function(e){e.preventDefault();var t={reason:"customer-rejected-installment",revision:n.revision};window.app.api.applications.close(n.applicationId,t,function(e,n){e&&console.warn(e),window.app.router.routeTo("/me")})}),n.$simulateButton.on("click",function(e){return e.preventDefault(),validateForm(n.$el)?(n.$el.find(".errors").hide(),n.$serverWait.show(),n.$el.find(".simulating-buttons").hide(),
void n.persistChanges(function(e){if(e.securityIsOwned===!1){if(e.vehicleSecurity.downPayment<.2*e.vehicleSecurity.value)return void setValidationError(n.$el.find("[name='vehicleSecurity.downPayment']"),["O valor da entrada deve ser no mínimo 20% do valor"]);if(e.vehicleSecurity.downPayment>.9*e.vehicleSecurity.value)return void setValidationError(n.$el.find("[name='vehicleSecurity.downPayment']"),["O valor da entrada deve ser no máximo 90% do valor"])}else if("car"===e.securityType&&e.appliedAmount>.8*e.vehicleSecurity.value)return void setValidationError(n.$el.find("[name='appliedAmount']"),["O valor do empréstimo deve ser no máximo 80% do valor do veículo"]);return"car"===e.securityType&&"truck"===e.securitySubtype&&e.loanPeriodInMonths>48?void setValidationError(n.$el.find("[name='loanPeriodInMonths']"),["Para essa modalidade, o número máximo de prestações é de 48"]):("home"===e.securityType,void window.app.api.applications.simulate(n.applicationId,{revision:e.revision},function(e,t){if(e)console.warn("persist ERROR:",e),window.location.reload();else if(n.$serverWait.hide(),n.revision=t.revision,n.simulated=!0,n.$el.find(".disable-simulated").find(":input").attr("disabled",!0),16===t.applicationState)n.$el.find(".simulation-rejected").show(),n.$el.find(".simulating-buttons").hide();else{var i="<b>"+numeral(t.simulation.minimumInstallment).format("$ 0,0.00")+"</b>";t.simulation.maximumInstallment-t.simulation.minimumInstallment>10&&(i=" de &nbsp;"+i+" até &nbsp;<b>"+numeral(t.simulation.maximumInstallment).format("$ 0,0.00")+"</b>"),n.$el.find(".simulated-installment").html(i),n.$el.find(".simulated-value").show(),n.$el.find(".simulating-buttons").hide();var o=t.householdMonthlyIncome||t.monthlyIncome;t.simulation.minimumInstallment>.3*o&&n.$el.find(".alert-installment-too-high").show()}}))})):void n.$el.find(".errors").show()}),n.persistChanges=function(e){window.app.api.applications.findFromId(n.applicationId,function(t,i){var o=gatherApplicationFormData(n.$el);for(var a in o)i[a]=o[a];"married"===i.civilStatus&&(i.hasCoApplicant=!0),""===i.accountType&&(i.accountType=null),null!=o.hasCreditRestrictions&&(i.hasCreditRestrictions="true"===o.hasCreditRestrictions),window.app.api.applications.update(n.applicationId,i,function(t,i){i&&(n.revision=i.revision),t&&t.error&&"Concurrency"!=t.error.slice(0,11)?(console.warn("update ERROR:",t),window.app.router.routeTo("/me")):i&&e&&"function"==typeof e&&e(i)})})},n.temporaryPersist=function(){n.persistChanges()},n.$el.find("input, select").on("change",n.temporaryPersist),n},registerComponent(".application-simulate",lending.components.applicationSimulateValues),ns("lending.components").navigateToLoan=function(e){var n=this;return n.$el=e,n.$el.on("click",function(){window.app.router.routeTo("/emprestimo-pessoal/"),window.location.reload(),window.scrollTo(0,0)}),n},ns("lending.components").navigateToRefin=function(e){var n=this;return n.$el=e,n.$el.on("click",function(e){window.location.reload(),window.scrollTo(0,0)}),n},ns("lending.components").navigateToFin=function(e){var n=this;return n.$el=e,n.$el.on("click",function(){window.app.router.routeTo("/refinanciamento-veiculo/"),window.location.reload(),window.scrollTo(0,0)}),n},ns("lending.components").navigateToFin=function(e){var n=this;return n.$el=e,n.$el.on("click",function(){window.app.router.routeTo("/financiamento-veiculo/"),window.location.reload(),window.scrollTo(0,0)}),n},ns("lending.components").navigateToLanding=function(e){var n=this;return n.$el=e,n.$el.on("click",function(){window.location.reload(),window.scrollTo(0,0)}),n},registerComponent(".button-nav-loan",lending.components.navigateToLoan),registerComponent(".button-nav-refin",lending.components.navigateToRefin),registerComponent(".button-nav-fin",lending.components.navigateToFin),registerComponent(".button-nav-lending",lending.components.navigateToLanding),ns("lending.components").campain=function(e){var n=this;return n.$el=e,n.campaignId=n.$el.find('[name="campaignId"]').val(),n.campaignState=n.$el.find('[name="campaignState"]').val(),n.supplier=n.$el.find('[name="supplier"]').val(),n.selectBank=n.$el.find('[name="selectBank"]').val(),n.gatherFormData=function(){var e=gatherApplicationFormData(n.$el);return""===e.bankName||"bv"==n.supplier&&("237"===e.bankName||"033"===e.bankName)?n.$el.find(".campaign-branch").hide():n.$el.find(".campaign-branch").show(),e},n.init=function(){"ready"===n.campaignState?n.$el.find(".header-questions").hide():n.$el.find(".header-ready").hide(),"ready"===n.campaignState?window.app.api.campaigns.cloneApplication(n.campaignId,{trackingData:window.app.getTrackingData()},function(e,n){e?console.warn("Error cloning application",e):console.log("Application cloned",n)}):n.gatherFormData()},n.submitForm=function(e){if(e.preventDefault(),!validateForm(n.$el))return void n.$el.find(".errors").show();n.$el.find(".errors").hide(),disableSubmit();var t=n.gatherFormData();t?(n.$el.find(".errors").hide(),postData={supplierBranchCode:t.branchCode,bankName:t.bankName,accountType:t.accountType,trackingData:window.app.getTrackingData()},window.app.api.campaigns.cloneApplication(n.campaignId,postData,function(e,t){e?console.log("Error cloning application",e):(console.log("Application cloned",t),n.$el.find(".campaign-not-ready").hide(),n.$el.find(".bank-section").hide(),n.$el.find(".campaign-branch").hide(),n.$el.find(".header-questions").hide(),n.$el.find(".header-ready").show(),postData.supplierBranchCode&&postData.supplierBranchCode.length>0?n.$el.find(".finish-store").show():n.$el.find(".finish-callcenter").show())})):n.$el.find(".errors").show()},n.$el.on("submit",n.submitForm),n.$el.find("input, select").on("blur",n.gatherFormData),n.$el.find("input, select").on("change",n.gatherFormData),n},ns("lending.components").change_phone_campaign=function(e){var n=this;n.$el=e;var t=null,i=n.$el.find('[name="telephoneNumber"]').attr("stateFilter"),o=!0;n.$el.find('[name="telephoneNumber"]').val()&&(t=n.$el.find('[name="telephoneNumber"]').val().substring(0,2)),n.changeListOfAddres=function(){o=!0;var e=n.$el.find('[name="telephoneNumber"]').val().substring(1,3);$($.grep($("#addressBankCampaign option"),function(e,n){$("#addressBankCampaign option").show()})),$($.grep($("#addressBankCampaign option"),function(n,t){""!=n.id&&null!=n.id&&(e!=n.id?$("#addressBankCampaign option[id="+n.id+"]").hide():o=!1)})),o&&($("#addressBankCampaign option[stateFilter="+i.toLowerCase()+"]").show(),"none"!=$("#addressBankCampaign option").attr("display")&&(o=!1)),o&&(alert("show all"),$("#addressBankCampaign option").show())},n.init=function(){o=!0,$($.grep($("#addressBankCampaign option"),function(e,n){""!=e.id&&null!=e.id&&""!=t&&null!=t&&(t!=e.id?$("#addressBankCampaign option[id="+e.id+"]").hide():o=!1)})),o&&($("#addressBankCampaign option[stateFilter="+i.toLowerCase()+"]").show(),"none"!=$("#addressBankCampaign option").attr("display")&&(o=!1)),o&&$("#addressBankCampaign option").show()},n.$el.find('[name="telephoneNumber"]').on("change",n.changeListOfAddres)},registerComponent(".campaign-form",lending.components.campain),registerComponent(".phone-number-campaign",lending.components.change_phone_campaign),ns("lending.components").collapsableList=function(e){var n=this;return n.$el=e,n.init=function(){n.$el.find(".collapsable-opener").on("click",function(e){var n=$(this);n.parent().addClass("opened"),n.siblings().show()})},n},registerComponent(".collapsable-list",lending.components.collapsableList),ns("lending.components").inputMask=function(e){var n=this;return n.$el=e,n.mask=n.$el.attr("data-input-mask"),VMasker(n.$el).maskPattern(n.mask),n},ns("lending.components").inputMaskMoney=function(e){var n=this;n.$el=e;var t=Number(n.$el.attr("money-input-mask"));return n.maskopt={precision:t,delimiter:".",unit:"R$ "},VMasker(n.$el).maskMoney(n.maskopt),n},registerComponent("[money-input-mask]",lending.components.inputMaskMoney),registerComponent("[data-input-mask]",lending.components.inputMask),ns("lending.components")._modalManager=function(){var e=this;return e.registeredModals={},e.$modalContainer=$('<div class="modal-container"></div>'),e.$modalContainer.hide(),e.modalVisible=!1,e.currentModal=null,e.$modalContainer.on("click",function(){e.hideModal()}),$("body").append(e.$modalContainer),e.clearModals=function(){e.$modalContainer.html(""),e.registeredModals={}},e.registerModal=function(n){e.registeredModals[n.getId()]=n,n.$el.remove(),n.$el.on("click",function(e){e.stopPropagation()}),e.$modalContainer.append(n.$el)},e.formatId=function(e){return e&&0===e.indexOf("#")&&(e=e.substring(1)),e},e.hideModal=function(n){e.modalVisible===!0&&(e.$modalContainer.fadeTo(200,0),e.currentModal.hide(function(){e.$modalContainer.hide(),e.currentModal=null,e.modalVisible=!0,n&&n()}))},e.toggleModal=function(n){n=e.formatId(n);var t=e.registeredModals[n];t&&(e.$modalContainer.fadeTo(0,0),e.$modalContainer.show(),e.$modalContainer.fadeTo(200,1),t.show(),e.currentModal=t,e.modalVisible=!0)},e};var _modalManager=new lending.components._modalManager;ns("lending.components").modal=function(e){var n=this;return n.$el=e,n.show=function(){n.$el.addClass("show"),setTimeout(function(){n.$el.addClass("activate-animation")},10)},n.hide=function(e){n.$el.removeClass("activate-animation"),setTimeout(function(){n.$el.removeClass("show"),e()},200)},n.getId=function(){return n.$el.attr("id")},_modalManager.registerModal(n),n},ns("lending.components").modalShow=function(e){var n=this;return n.$el=e,n.targetModalId=n.$el.data("modal-target"),n.$el.on("click",function(e){e.preventDefault(),_modalManager.toggleModal(n.targetModalId)}),n},ns("lending.components").modalClose=function(e){var n=this;return n.$el=e,n.$el.on("click",function(){_modalManager.hideModal()}),n},registerComponent(".modal",lending.components.modal),registerComponent("[data-modal-show]",lending.components.modalShow),registerComponent("[data-modal-close]",lending.components.modalClose),ns("lending.components").branchesList=function(e){var n=this;n.$el=e,n.$stateFilter=n.$el.find('[name="stateFilter"]'),n.$cityFilter=n.$el.find('[name="cityFilter"]'),n.initialFillForm=function(){n.$stateFilter[0].value;n.$stateFilter,n.$stateFilter.append($("<option></option>").attr("value","").text("Todos")),$.each(n.citiesIbi,function(e,t){n.$stateFilter.append($("<option></option>").attr("value",t.state).text(t.state))}),n.updateStateFilter()},n.updateStateFilter=function(){var e=n.$stateFilter[0].value;n.$cityFilter.empty(),n.$cityFilter.append($("<option></option>").attr("value","").text("Todos")),$.each(n.citiesIbi,function(t,i){i.state===e&&$.each(i.cities,function(e,t){n.$cityFilter.append($("<option></option>").attr("value",t).text(t))})}),n.updateBranchesFilter()},n.updateBranchesFilter=function(){var e=function(e){var n=document.createElement("tr"),t=document.createAttribute("class");t.value="branches-list-item",n.setAttributeNode(t);var i=document.createElement("td");i.innerHTML=e.name,n.appendChild(i),i=document.createElement("td"),i.innerHTML=e.state,n.appendChild(i),i=document.createElement("td"),i.innerHTML=e.city,n.appendChild(i),i=document.createElement("td"),i.innerHTML=e.phone,n.appendChild(i),i=document.createElement("td");var o=e.address1;return e.number&&e.number.length>0&&(o+="&nbsp;"+e.number),e.address2&&e.address2.length>0&&(o+="<br />"+e.address2),e.neighbourhood&&e.neighbourhood.length>0&&(o+=" - "+e.neighbourhood),i.innerHTML=o,n.appendChild(i),n};$("#branches_list tr.branches-list-item").remove();var t=n.$stateFilter[0].value,i=n.$cityFilter[0].value;$.each(n.branchesIbi,function(n,o){0!==t.length&&t!==o.state||0!==i.length&&i!==o.city||$("#branches_list > tbody:last").append(e(o))})},n.$stateFilter.on("change",n.updateStateFilter),n.$cityFilter.on("change",n.updateBranchesFilter),n.branchesIbi=[{branchCode:"IAA",name:"IAA",zipCode:"57300-330",state:"AL",city:"Arapiraca",address1:"Praça Deputado Marques Silva, nº 125",neighbourhood:"Centro",manager:"Paullo Oliveira",phone:"(82) 3522-6513",email:""},{branchCode:"IMA",name:"IMA",zipCode:"69005-160",state:"AM",city:"Manaus",address1:"Av. Eduardo Ribeiro, 218",neighbourhood:"Centro",manager:"Daniele Oliveira",phone:"(92) 2125-0000",email:""},{branchCode:"ICI",name:"ICI",zipCode:"42800-040",state:"BA",city:"Camaçari",address1:"Rua Costa Pinto, nº 03",neighbourhood:"Centro",manager:"Gabriela",phone:"(71) 2102-0072",email:""},{branchCode:"IEN",name:"IEN",zipCode:"45820-002",state:"BA",city:"Eunápolis",address1:"Avenida Porto Seguro, nº 441",neighbourhood:"Centro",manager:"Francisco",phone:"(73) 32617072",email:""},{branchCode:"IIT",name:"IIT",zipCode:"45600-004",state:"BA",city:"Itabuna",address1:"Rua Cinquentenario, nº 592",neighbourhood:"Centro",manager:"",phone:"(73) 3616-1185",email:""},{branchCode:"IJQ",name:"IJQ",zipCode:"45200-005",state:"BA",city:"Jequié",address1:"Av. Alves Pereira, nº 32",neighbourhood:"Centro",manager:"Michele",phone:"(73) 3526-3347",email:""},{branchCode:"IBJ",name:"IBJ",zipCode:"48903-400",state:"BA",city:"Juazeiro",address1:"Praça Barão do Rio Branco, nº 11",neighbourhood:"Centro",manager:"Emine Valeriano",phone:"(74) 2102-1302",email:""},{branchCode:"ISI",name:"ISI",zipCode:"41820-020",state:"BA",city:"Salvador",address1:"Av. Tancredo Neves, 148 - nº 01 a 03 - quadra Q 2º piso - Al. Martha Rocha",neighbourhood:"Shopping Iguatemi",manager:"Vandilson Jesus",phone:"(71) 2102-0003",email:""},{branchCode:"ISL",name:"ISL",zipCode:"40050-002",state:"BA",city:"Salvador",address1:"Av. Joana Angélica, nº 16",neighbourhood:"Nazaré",manager:"Edinalva",phone:"(71) 2104-0003",email:""},{branchCode:"ITF",name:"ITF",zipCode:"45995-000",state:"BA",city:"Texeira de Freitas",address1:"Rua Zilda Arnes Neumann, nº. 42",neighbourhood:"Centro",manager:"Gerlaine Matos",phone:"(73) 3291-2521",email:"Próximo a Via S1 Paralela a Eixo Monumental"},{branchCode:"IVQ",name:"IVQ",zipCode:"45000-380",state:"BA",city:"Vitória da Conquista",address1:"Al. Ramiro Santos, 05",neighbourhood:"Centro",manager:"Alda Silva",phone:"(77) 2101-0079",email:""},{branchCode:"INF",name:"INF",zipCode:"60325-002",state:"CE",city:"Fortaleza",address1:"Av. Bezerra de Menezes, nº 2450 - Lj 411/412 - North Shopping",neighbourhood:"São Gerardo",manager:"",phone:"(85) 3305-0005",email:"Esquina com a Av. Henriqueta Mendes Guerra / Próximo a Caixa Econômica"},{branchCode:"IBR",name:"IBR",zipCode:"70391-900",state:"DF",city:"Brasília",address1:"SDS Bloco A, Ed. Boulevard Center, 41 - Loja 4 e 5",neighbourhood:"Conic",manager:"Maysa",phone:"(61) 2107-0070",email:"Esquina Av. Celeste"},{branchCode:"ICE",name:"ICE",zipCode:"72210-504",state:"DF",city:"Ceilândia",address1:"Rua CMN 02, Bloco D, Lote 5",neighbourhood:"Centro",manager:"Elizanja Magalhaes",phone:"(61) 2102-0036",email:"Travessa Hélio Prates"},{branchCode:"IDP",name:"IDP",zipCode:"73310-300",state:"DF",city:"Distrito federal",address1:"SHD Bloco K Lote 4",neighbourhood:"Planaltina",manager:"Leandro",phone:"(61) 3389-5963",email:""},{branchCode:"IDG",name:"IDG",zipCode:"72404-901",state:"DF",city:"Gama",address1:"Bloco 03, Lotes 21/39, Loja A-1, Térreo",neighbourhood:"Setor Central do Gama",manager:"Laide",phone:"(61) 3385-5531",email:""},{branchCode:"IDS",name:"IDS",zipCode:"73070-043",state:"DF",city:"Sobradinho",address1:"SB Quadra Central Bloco 9 - Lote 2 - Loja 2",neighbourhood:"Centro",manager:"Carla Guimaraes",phone:"(61) 3387-7696",email:"Ao lado da loja Macedo"},{branchCode:"ITG",name:"ITG",zipCode:"72010-080",state:"DF",city:"Taguatinga",address1:"Av. Central 08, lote 09 - loja 01",neighbourhood:"Centro",manager:"Viviane Martins",phone:"(61) 2103-0001",email:"Próximo ao metrô"},{branchCode:"IGN",name:"IGN",zipCode:"74505-016",state:"GO",city:"Goiânia",address1:"Avenida 24 de Outubro nº 1559 Quadra 37 Lj6",neighbourhood:"Campinas",manager:"Nubia",phone:"(62) 3233-1477",email:""},{branchCode:"ILZ",name:"ILZ",zipCode:"65020-250",state:"MA",city:"São Luis",address1:"Rua Oswaldo Cruz, 634",neighbourhood:"Centro",manager:"Liana Barbosa",phone:"(98) 2106-0001",email:"Travessa Av. Senador Saraiva / ao lado da CEA"},{branchCode:"IAM",name:"IAM",zipCode:"30180-000",state:"MG",city:"Belo Horizonte",address1:"Av. Amazonas, nº 507, loja 06",neighbourhood:"Centro",manager:"Adjane Rodrigues",phone:"(31) 2112-0006",email:""},{branchCode:"IAP",name:"IAP",zipCode:"30130-003",state:"MG",city:"Belo Horizonte",address1:"Avenida Afonso Pena, nº 914",neighbourhood:"Centro",manager:"Pollyanna oliveira",phone:"(31) 2123-0007",email:""},{branchCode:"IBH",name:"IBH",zipCode:"30170-120",state:"MG",city:"Belo Horizonte",address1:"Rua Curitiba, 697",neighbourhood:"Centro",manager:"Polyanna",phone:"(31) 2191-0091",email:"Paralela a Av. Antônio Piranga"},{branchCode:"ICT",name:"ICT",zipCode:"32310-000",state:"MG",city:"Contagem",address1:"Av. João César de Oliveira, 2692 e 2700",neighbourhood:"Centro",manager:"Erica Alves",phone:"(31) 2103-0001",email:""},{branchCode:"IJF",name:"IJF",zipCode:"36010-003",state:"MG",city:"Juiz de Fora",address1:"Rua Halfed, nº 811",neighbourhood:"Centro",manager:"Douglas",phone:"(32) 2101 0000",email:""},{branchCode:"IMS",name:"IMS",zipCode:"33105-510",state:"MG",city:"Santa Luzia",address1:"Av. Brasilia, 1907/1911 esquina c/ Rua Alvorada, 281",neighbourhood:"São Benedito",manager:"Dnamara Oliveira",phone:"(31) 3634-1155",email:""},{branchCode:"ILO",name:"ILO",zipCode:"35700-009",state:"MG",city:"Sete Lagoas",address1:"Avenida Dep. Emílio Vasconcelos Costa, 149",neighbourhood:"Centro",manager:"Junia",phone:"(31) 3773-1585",email:""},{branchCode:"IUA",name:"IUA",zipCode:"38010020",state:"MG",city:"Uberaba",address1:"Rua Arthur Machado n 125",neighbourhood:"Centro",manager:"",phone:"(34) 3315-2012",email:"Esquina com a Rua Trajano"},{branchCode:"IUB",name:"IUB",zipCode:"38400-186",state:"MG",city:"Uberlândia",address1:"Praça Tubal Vilela, 181",neighbourhood:"Centro",manager:"Nivia Silva",phone:"(34) 21010003",email:"Paralela a Av. Brasil / Próximo ao Veran"},{branchCode:"IBC",name:"IBC",zipCode:"66645-000",state:"PA",city:"Belém",address1:"Rodovia BR 316, km 01, s/ nº lojas 307/309- Shopping Castanheira Lojas 307-309",neighbourhood:"Castanheira",manager:"Leticia",phone:"(91) 3204-0011",email:"Próximo ao Viaduto / enfrente a Estação venlha de Guaianases"},{branchCode:"IBE",name:"IBE",zipCode:"66019-060",state:"PA",city:"Belém",address1:"Rua Conselheiro João Alfredo, 369",neighbourhood:"Centro",manager:"Regilene",phone:"(91) 4006-0094",email:""},{branchCode:"IIB",name:"IIB",zipCode:"66025-230",state:"PA",city:"Belém",address1:"Travessa Padre Eutiquio, 1087",neighbourhood:"Campina",manager:"Greice",phone:"(91) 3204-0015",email:"adriana.pereira@ibilojas.com.br"},{branchCode:"ISE",name:"ISE",zipCode:"68005-010",state:"PA",city:"Santarém",address1:"Rua Senador Lameira Bittencourt. 328",neighbourhood:"Centro",manager:"Andrev",phone:"(93) 3522-0188",email:""},{branchCode:"IDQ",name:"IDQ",zipCode:"25010-143",state:"RJ",city:"Duque de Caxias",address1:"Rua Nilo Peçanha, nº 84",neighbourhood:"Centro",manager:"",phone:"(21) 2106-0005",email:""},{branchCode:"IIG",name:"IIG",zipCode:"21921-000",state:"RJ",city:"Ilha do Governador",address1:"Estrada da Cacuia, nº 189",neighbourhood:"Ilha do Govenador",manager:"Romar Sousa",phone:"(21) 2467-1310",email:"Próximo ao Boticário"},{branchCode:"INL",name:"INL",zipCode:"26520-332",state:"RJ",city:"Nilópolis",address1:"Estrada da Mirandela, nº 28",neighbourhood:"Centro",manager:"Ana Cristina",phone:"(21) 3760-8510",email:""},{branchCode:"INT",name:"INT",zipCode:"24020-002",state:"RJ",city:"Niterói",address1:"Av. Visconde do Rio Branco, nº 327",neighbourhood:"Centro",manager:"Damiana",phone:"(21) 2109 0000",email:""},{branchCode:"INI",name:"INI",zipCode:"26210-012",state:"RJ",city:"Nova Iguaçu",address1:"Av. Nilo Peçanha, nº 84/86 - Cj. 107",neighbourhood:"Centro",manager:"Joel",phone:"(21) 2108-0009",email:""},{branchCode:"IPO",name:"IPO",zipCode:"25620-002",state:"RJ",city:"Petrópolis",address1:"Rua do Imperador, nº 449/453",neighbourhood:"Centro",manager:"Lucimar",phone:"(24) 2103 0020",email:""},{branchCode:"IBG",name:"IBG",zipCode:"21810-012",state:"RJ",city:"Rio de Janeiro",address1:"Av. Cônego de Vasconcelos, 82 LJ A",neighbourhood:"Bangu",manager:"Joselaine",phone:"(21) 2109 0015",email:""},{branchCode:"IBS",name:"IBS",zipCode:"21041-010",state:"RJ",city:"Rio de Janeiro",address1:"Praça das Nações, nº 228",neighbourhood:"Bom Sucesso",manager:"Thiago",phone:"(21) 3078-0068",email:"Esquina com a Rua Clemente Álvares / Enfrente a Loja Gabriela"},{branchCode:"ICG",name:"ICG",zipCode:"23050-360",state:"RJ",city:"Rio de Janeiro",address1:"Rua Coronel Agostinho, nº 43",neighbourhood:"Campo Grande",manager:"Jhessen",phone:"(21) 2415 7818",email:"Enfrente a Igreja Matriz"},{branchCode:"ICO",name:"ICO",zipCode:"22050-001",state:"RJ",city:"Rio de Janeiro",address1:"Rua Barata Ribeiro, nº 458",neighbourhood:"Copacabana",manager:"Alexandre",phone:"(21) 2102 0004",email:""},{branchCode:"IJC",name:"IJC",zipCode:"22730-001",state:"RJ",city:"Rio de Janeiro",address1:"Av. Nelson Cardoso, nº 1270 - Loja A",neighbourhood:"Jacarepaguá",manager:"raphaela",phone:"(21) 2107 0003",email:"Enfrente a Loja Besni / Próximo a Praça Floriano Peixoto"},{branchCode:"IMD",name:"IMD",zipCode:"21351-050",state:"RJ",city:"Rio de Janeiro",address1:"Estrada do Portela, nº 77",neighbourhood:"Madureira",manager:"",phone:"(21) 2451 9380",email:""},{branchCode:"IME",name:"IME",zipCode:"20720-010",state:"RJ",city:"Rio de Janeiro",address1:"Rua Dias da Cruz , nº 255 - 1º Pavimento - lojas 103/104",neighbourhood:"Meier",manager:"Lorena Guerra",phone:"(21) 97965-0440",email:""},{branchCode:"INH",name:"INH",zipCode:"20771-004",state:"RJ",city:"Rio de Janeiro",address1:"Av. Dom Helder Camara, nº 5332",neighbourhood:"Pilares",manager:"",phone:"(21) 2102 0098",email:""},{branchCode:"ISR",name:"ISR",zipCode:"23515-000",state:"RJ",city:"Rio de Janeiro",address1:"Rua Felipe Cardoso, nº83",neighbourhood:"Santa Cruz",manager:"",phone:"(21) 2125 0012",email:""},{branchCode:"IUR",name:"IUR",zipCode:"20050-093",state:"RJ",city:"Rio de Janeiro",address1:"Rua Uruguaiana, nº 20",neighbourhood:"Centro",manager:"Lorena Gerra",phone:"(21) 2126 0051",email:"Em frente a Riachuelo"},{branchCode:"IAL",name:"IAL",zipCode:"24710-460",state:"RJ",city:"São Gonçalo",address1:"Rua Yolanda Saad Abuzaid, nº 80/ Lojas 7 , 8 e 22",neighbourhood:"Alcântara",manager:"Henrique Silva",phone:"(21) 2101 0006",email:"Esquina com a Rua Arlindo Colaço"},{branchCode:"ISG",name:"ISG",zipCode:"24440-440",state:"RJ",city:"São Gonçalo",address1:"Rua Dr. Feliciano Sodré, 215 - ljs 4 e 5 sjlj",neighbourhood:"Centro",manager:"Priscila",phone:"(21) 2109 0003",email:""},{branchCode:"ISJ",name:"ISJ",zipCode:"25520-640",state:"RJ",city:"São João do Meriti",address1:"Rua da Matriz, nº 161",neighbourhood:"Centro",manager:"Bruna",phone:"(21) 2101 0003",email:"Enfrente ao Santander / Esquina com Rua Dr. Felice Buscaglia"},{branchCode:"IVR",name:"IVR",zipCode:"27260-315",state:"RJ",city:"Volta Redonda",address1:"Rua Brás Magaldi Fernandes (antiga Rua Doze), nº 26 - Loja 333",neighbourhood:"Centro",manager:"Pamela",phone:"(24) 2102 0004",email:""},{branchCode:"IPV",name:"IPV",zipCode:"76801-073",state:"RO",city:"Porto Velho",address1:"Av. Sete de Setembro, 851",neighbourhood:"Centro",manager:"Marcilene",phone:"(69) 2181-0007",email:""},{branchCode:"ICN",name:"ICN",zipCode:"92010-260",state:"RS",city:"Canoas",address1:"Rua Tiradentes, 325",neighbourhood:"Centro",manager:"Cristina",phone:"(51) 2101-0000",email:""},{branchCode:"IFL",name:"IFL",zipCode:"88010-000",state:"SC",city:"Florianópolis",address1:"Rua Felipe Schmidt, 61",neighbourhood:"Centro",manager:"Franciele",phone:"(48) 2106-0096",email:""},{branchCode:"IBU",name:"IBU",zipCode:"06401-000",state:"SP",city:"Barueri",address1:"Rua Campos Sales, 141",neighbourhood:"Centro",manager:"Midiã",phone:"(11) 4198 6175",email:""},{branchCode:"ICP",name:"ICP",zipCode:"13010-071",state:"SP",city:"Campinas",address1:"Rua Treze de Maio, nº 506",neighbourhood:"Centro",manager:"Cibele",phone:"19- 2104-0003",email:""},{branchCode:"ICA",name:"ICA",zipCode:"06311-000",state:"SP",city:"Carapicuíba",address1:"Avenida Rui Barbosa, 515 - Térreo",neighbourhood:"Centro",manager:"Debora",phone:"(11) 2108 0004",email:"Enfrente ao Super Shopping"},{branchCode:"IDI",name:"IDI",zipCode:"09911-160",state:"SP",city:"Diadema",address1:"Avenida Antonio Piranga, 70",neighbourhood:"Centro",manager:"André",phone:"(11) 2103-0005",email:"Enfrente a loja ShoeBiz / Esquina com a Rua Padre Antônio Benedito"},{branchCode:"IFV",name:"IFV",zipCode:"08500-405",state:"SP",city:"Ferraz de Vasconcelos",address1:"Av. XV de Novembro, 42",neighbourhood:"Centro",manager:"",phone:"(11) 4679 5400",email:"Esquina com a Rua Cunha Gago / Enfrente ao Itaú"},{branchCode:"IGS",name:"IGS",zipCode:"07011-010",state:"SP",city:"Guarulhos",address1:"Rua Capitão Gabriel, nº16",neighbourhood:"Centro",manager:"Juliete",phone:"(11) 2105 0016",email:""},{branchCode:"ITV",name:"ITV",zipCode:"06653-005",state:"SP",city:"Itapevi",address1:"Avenida Rubens Caramez, nº 73",neighbourhood:"Jd. Itapevi",manager:"Adriana",phone:"(11) 3543 0015",email:""},{branchCode:"IJN",name:"IJN",zipCode:"13200-001",state:"SP",city:"Jundiaí",address1:"Rua do Rosário, 291",neighbourhood:"Centro",manager:"",phone:"(11) 2152 0005",email:"Travessa Av. Rio Branco / Próximo ao Banco do Brasil"},{branchCode:"IMU",name:"IMU",zipCode:"09390-040",state:"SP",city:"Mauá",address1:"Lojas 79 e 81 do Mauá Plaza Shopping, na Av. Governador Mário Covas Jr, nº 01",neighbourhood:"Vila Fausto Neves Morelli",manager:"Joana",phone:"(11) 2109-0003",email:"Esquina com a Rua Dona Elisa Fláquer"},{branchCode:"IMG",name:"IMG",zipCode:"08710-430",state:"SP",city:"Mogi das Cruzes",address1:"Rua Doutor Deodato Wertheimer, 1431",neighbourhood:"Centro",manager:"Bruna",phone:"(11) 4796 6466",email:"Esquina com a Rua Dr. Fáquer"},{branchCode:"IOS",name:"IOS",zipCode:"06016-060",state:"SP",city:"Osasco",address1:"Rua Ten. Avelar Pires de Azevedo, nº 81 - lj 117",neighbourhood:"Shopping B. Osasco Plaza",manager:"Everton",phone:"(11) 2109 0000",email:"Travessa Rua Praça Afonso Pena / ao lado da Riachuelo"},{branchCode:"z",name:"z",zipCode:"13400-070",state:"SP",city:"Piracicaba",address1:"Rua Governador Pedro de Toledo, 1053",neighbourhood:"Centro",manager:"Mauricio",phone:"19 3402 8775",email:""},{branchCode:"IRP",name:"IRP",zipCode:"14010-000",state:"SP",city:"Ribeirão Preto",address1:"Rua General Osório, 286 / 294",neighbourhood:"Centro",manager:"Sandro",phone:"16 2101 0001",email:""},{branchCode:"ISA",name:"ISA",zipCode:"09010-000",state:"SP",city:"Santo André",address1:"Rua Coronel Oliveira Lima, nº 450 / 454",neighbourhood:"Centro",manager:"Glauce",phone:"(11) 2135 0019",email:""},{branchCode:"IST",name:"IST",zipCode:"11060-300",state:"SP",city:"Santos",address1:"Av. Marechal Floriano Peixoto, 20",neighbourhood:"Gonzaga",manager:"Stefany",phone:"(13) 2101-0000",email:""},{branchCode:"ISB",name:"ISB",zipCode:"09710-012",state:"SP",city:"São Bernardo do Campo",address1:"Rua Marechal Deodoro, nº 1259",neighbourhood:"Centro",manager:"Neliana",phone:"(11) 2135 0020",email:""},{branchCode:"ISC",name:"ISC",zipCode:"12210-180",state:"SP",city:"São José dos Campos",address1:"Rua Rubiao junior, 65",neighbourhood:"Centro",manager:"André",phone:"12 2136 0000",email:"Travessa a Rua Voluntários da Pátria"},{branchCode:"ICL",name:"ICL",zipCode:"05787-000",state:"SP",city:"São Paulo",address1:"Estrada do Campo Limpo, 4245 e 4249",neighbourhood:"Campo Limpo",manager:"Gerente de licença",phone:"(11) 2164-0004",email:""},{branchCode:"IGA",name:"IGA",zipCode:"8410000",state:"SP",city:"São Paulo",address1:"Rua Salvador Gianetti, nº 1150",neighbourhood:"Guaianases",manager:"Natali",phone:"(11) 3808 9630",email:"Próximo a Praça da Independência"},{branchCode:"IIP",name:"IIP",zipCode:"08115-000",state:"SP",city:"São Paulo",address1:"Avenida Marechal Tito,4190",neighbourhood:"Itaim Paulista",manager:"Henrique",phone:"(11) 2109 0038",email:"Travessa Rua Monsenhor Nuno / Ao lado da Óticas Carol"},{branchCode:"ILA",name:"ILA",zipCode:"05073-001",state:"SP",city:"São Paulo",address1:"Rua Doze de Outubro, 259",neighbourhood:"Lapa",manager:"Rogerio",phone:"(11) 2109-0001",email:"Travessa com a Av. Mazzei"},{branchCode:"ILG",name:"ILG",zipCode:"04751-000",state:"SP",city:"São Paulo",address1:"Largo Treze de Maio, 468",neighbourhood:"Santo Amaro",manager:"Patricia",phone:"(11) 2167-0001",email:""},{branchCode:"ILT",name:"ILT",zipCode:"04751-010",state:"SP",city:"São Paulo",address1:"Rua Capitão Tiago Luz, 139 Loja 03 -Terréo",neighbourhood:"Santo Amaro",manager:"Igor Santos",phone:"(11) 2202-0002",email:""},{branchCode:"IMP",name:"IMP",zipCode:"08010-000",state:"SP",city:"São Paulo",address1:"Rua Serra Dourada, 170",neighbourhood:"São Miguel Paulista",manager:"Natália",phone:"(11) 2131 0009",email:"Ao lado da Cacau Show / ao lado das Casas Bahia"},{branchCode:"IMT",name:"IMT",zipCode:"03949-013",state:"SP",city:"São Paulo",address1:"Av. Mateu Bei, 3.377",neighbourhood:"São Mateus",manager:"Domênica",phone:"(11) 2101-0094",email:"Paralela a Estrada da Roselândia / Ao lado do Santander"},{branchCode:"IPH",name:"IPH",zipCode:"03606-000",state:"SP",city:"São Paulo",address1:"Rua Penha de França, 320/324",neighbourhood:"Penha de França",manager:"Leticia",phone:"(11) 2109 0009",email:""},{branchCode:"IPI",name:"IPI",zipCode:"05406-200",state:"SP",city:"São Paulo",address1:"Rua Teodoro Sampaio nº 2442",neighbourhood:"Pinheiros",manager:"Humberto",phone:"(11) 2101 0009",email:""},{branchCode:"ISN",name:"ISN",zipCode:"02034-020",state:"SP",city:"São Paulo",address1:"Rua Leite de Moraes, 57",neighbourhood:"Santana",manager:"Adailton",phone:"(11) 2141-0003",email:""},{branchCode:"ITC",name:"ITC",zipCode:"02305-000",state:"SP",city:"São Paulo",address1:"Av Tucuruvi, 351",neighbourhood:"Tucuruvi",manager:"Pollyana",phone:"(11) 2131-0010",email:"Enfrente ao Largo do Japonês"},{branchCode:"ITQ",name:"ITQ",zipCode:"08210-430",state:"SP",city:"São Paulo",address1:"Rua Gregório Ramalho, 257",neighbourhood:"Itaquera",manager:"Stephanie",phone:"(11) 2074-4141",email:""},{branchCode:"IVC",name:"IVC",zipCode:"02611-000",state:"SP",city:"São Paulo",address1:"Av. Parada Pinto, 19 e 21 térreo, nº 17 sala 06",neighbourhood:"Vila Nova Cachoerinha",manager:"vanessa",phone:"(11) 3859 5889",email:""},{branchCode:"ISZ",name:"ISZ",zipCode:"08674-001",state:"SP",city:"Suzano",address1:"Rua General Francisco Glicério nº 291",neighbourhood:"Centro",manager:"Bruna (Férias em fevereiro)",phone:"(11) 3468-0058",email:"Esquina com a Rua Quinze de Novembro / Ao lado da loja Tennis Bar"}];var t=[];$.each(n.branchesIbi,function(e,n){$.inArray(n.state,t)===-1&&t.push(n.state)});var i=[];return $.each(t,function(e,t){var o=t,a=[];$.each(n.branchesIbi,function(e,n){n.state===o&&$.inArray(n.city,a)===-1&&a.push(n.city)}),i.push({state:o,cities:a.sort()})}),n.citiesIbi=i,n.initialFillForm(),n},registerComponent(".partner-branches-listing",lending.components.branchesList),ns("lending.components").sideNav=function(e){var n=this;return n.$el=e,n.$sideNavListLinks=e.find(".side-nav-list a"),n.setActiveLink=function(){var e=window.location.pathname,t=null;n.$sideNavListLinks.each(function(n,i){i=$(i);var o=i.attr("href");if(e.indexOf(o)!==-1){if(null!==t){if(t.href.length>o.length)return;t.e.removeClass("active")}i.addClass("active"),t={href:o,e:i}}})},n.init=function(){n.setActiveLink()},n},registerComponent(".side-nav",lending.components.sideNav),ns("lending.components").timeCountdown=function(e){var n=this;return n.$el=e,n.init=function(){var e=moment(n.$el.data("to"),"YYYY-MM-DDTh:mm:ss"),t=function(){n.$el.html("");var t=moment.utc(e.diff(new Date)),i=t.format("DD"),o=t.format("hh"),a=t.format("mm"),r=t.format("ss");n.$el.append($('<span class="time-countdown-days"></span>').html(i)),n.$el.append($('<span class="time-countdown-hours"></span>').html(o)),
n.$el.append($('<span class="time-countdown-minutes"></span>').html(a)),n.$el.append($('<span class="time-countdown-seconds"></span>').html(r))};t(),setInterval(t,1e3)},n},registerComponent(".time-countdown",lending.components.timeCountdown),ns("lending.components").visibleIfChecked=function(e){var n=this;return n.$el=e,n.target=$(n.$el.data("visible-if-checked")),n.updateVisibility=function(){n.target.is(":checked")?n.$el.show():n.$el.hide()},n.updateVisibility(),n.target.on("change",n.updateVisibility),n},ns("lending.components").visibleIfNotChecked=function(e){var n=this;return n.$el=e,n.target=$(n.$el.data("visible-if-not-checked")),n.updateVisibility=function(){n.target.is(":checked")?n.$el.hide():n.$el.show()},n.updateVisibility(),n.target.on("change",n.updateVisibility),n},registerComponent("[data-visible-if-checked]",lending.components.visibleIfChecked),registerComponent("[data-visible-if-not-checked]",lending.components.visibleIfNotChecked),ns("lending.controllers").admin=function(e){var n=this;return n.app=e.app,n.index=function(){n.app.setView(templatizer.admin.index)},n.auth={index:function(){n.app.setView(templatizer.admin.auth.index)},create:function(){n.app.setView(templatizer.admin.auth.create)},view:function(e){n.app.setView(templatizer.admin.auth.view,{id:e})}},n.applications={index:function(){var e=querystring("page")||1,t=querystring("status")||"leads";switch(t){case"leads":statusFn=n.app.api.applications.leads;break;case"leads-sg":statusFn=n.app.api.applications.leadsSg;break;case"started":statusFn=n.app.api.applications.started;break;case"started-sg":statusFn=n.app.api.applications.startedSg;break;case"has-bids":statusFn=n.app.api.applications.hasBids;break;case"accept":statusFn=n.app.api.applications.hasAccept;break;case"follow-up":statusFn=n.app.api.applications.followUp;break;case"closed":statusFn=n.app.api.applications.closed;break;case"archive":statusFn=n.app.api.applications.archive;break;default:statusFn=n.app.api.applications.all}statusFn(e,function(i,o){n.app.setView(templatizer.admin.applications.index,{applications:o,status:t,page:Number(e)})})},view:function(e){window.app.api.applications.findFromId(e,function(e,t){n.app.setView(templatizer.admin.applications.view,{application:t})})}},n["export"]={index:function(){n.app.setView(templatizer.admin["export"].index)}},n.suppliers={index:function(){n.app.setView(templatizer.admin.suppliers.index)},create:function(){n.app.setView(templatizer.admin.suppliers.create)},view:function(e){n.app.setView(templatizer.admin.suppliers.view,{id:e})}},n.app.protectWithRoleLevel(["admin"],n,n.auth,n.auctions,n.suppliers,n["export"]),n},ns("lending.controllers").campaigns=function(e){var n=this;return n.app=e.app,n.expired=function(){var e=templatizer.campaign.expired;n.app.setView(e)},n.view=function(e,t,i){i||(i=t,t=e,e="bv"),e=e.toLowerCase(),window.app.api.campaigns.getFromAppId(t,i,function(t,i){if(t)window.app.router.routeTo("/campaign/expired");else if(i.supplier!==e)console.warn("unknown supplier"),window.app.router.routeTo("/me");else{var o=templatizer.campaign.view;n.app.setView(o,{supplier:e,campaign:i})}})},n},ns("lending.controllers").crm=function(e){var n=this;return n.app=e.app,n.index=function(){n.app.setView(templatizer.crm.index)},n.applications={view:function(e){n.app.showLoader(),n.app.api.applications.findFromId(e,function(e,t){n.app.hideLoader(),n.app.setView(templatizer.crm.applications.view,{application:t})})},index:function(){n.app.showLoader();var e=null;switch(querystring("status")){case"started":e=n.app.api.applications.started;break;case"has-bids":e=n.app.api.applications.hasBids;break;case"accept":e=n.app.api.applications.hasAccept;break;case"follow-up":e=n.app.api.applications.followUp;break;case"closed":e=n.app.api.applications.closed;break;case"archive":e=n.app.api.applications.archive;break;default:e=n.app.api.applications.all}e(1,function(e,t){return n.app.hideLoader(),e?void alert(e.error):void n.app.setView(templatizer.crm.applications.index,{applications:t,status:querystring("status")})})}},n.app.protectWithRoleLevel(["sales","advisor","admin"],n),n},ns("lending.controllers").home=function(e){var n=this;return n.app=e.app,n.error404=function(){n.app.setView(templatizer.home.error404)},n},ns("lending.controllers").login=function(e){var n=this;return n.app=e.app,n.index=function(){n.app.setView(templatizer.login.index)},n.loginWithPassword=function(){n.app.setView(templatizer.login.password)},n.loginFromToken=function(e){window.app.setAuth(e),window.app.verifyAuth(function(e){e?window.app.router.routeTo("/login"):window.app.routeAfterLogin()})},n},ns("lending.controllers").me=function(e){var n=this;return n.app=e.app,n.index=function(){n.app.api.applications.me(function(e,t){e||(n.app.setView(templatizer.me.index,{applications:t}),$(".modal-cp").iziModal({title:"Emprestimo Pessoal.",subtitle:"Saiba como funciona",headerColor:"#43B69A"}),$(".modal-fin").iziModal({title:"Financiamento de veículo",subtitle:"Saiba como funciona",headerColor:"#43B69A"}),$(".modal-car").iziModal({title:"Refinanciamento de Veículo.",subtitle:"Saiba como funciona",headerColor:"#43B69A"}),$(".modal-home").iziModal({title:"Refinanciamento de Imóvel.",subtitle:"Saiba como funciona",headerColor:"#43B69A"}),$(".modal-cp-disabled").iziModal({title:"Emprestimo Pessoal.",subtitle:"Limite mensal de pedidos",headerColor:"#43B69A"}),$(".modal-fin-disabled").iziModal({title:"Financiamento de veículo",subtitle:"Limite mensal de pedidos",headerColor:"#43B69A"}),$(".modal-car-disabled").iziModal({title:"Refinanciamento de Veículo.",subtitle:"Limite mensal de pedidos",headerColor:"#43B69A"}),$(".modal-home-disabled").iziModal({title:"Refinanciamento de Imóvel.",subtitle:"Limite mensal de pedidos",headerColor:"#43B69A"}))})},n.applications={view:function(e){n.app.api.applications.findFromId(e,function(e,t){return e&&"Not found"===e.error.slice(0,9)?void n.app.router.routeTo("/me"):void(e?console.log("me,view:",e):n.app.setView(templatizer.me.applications.view,{application:t}))})}},n.offers={index:function(e,t){n.app.api.applications.findFromId(e,function(e,i){var o=_.chain(i.auction.bids).filter(function(e){return e.id===t}).first().value();n.app.setView(templatizer.me.offers.view,{application:i,bid:o})})},accepted:function(e){n.app.setView(templatizer.me.offers.accepted)}},n.newapplication=function(){n.app.api.applications.me(function(e,t){if(!e){for(var i={},o=0;o<t.length;++o)(null==i.created||t[o].created>i.created)&&(i=t[o]);n.app.setView(templatizer.me.newapplication,{application:i})}})},n.app.protectWithRoleLevel(["customer"],n),n},ns("lending.controllers").partner=function(e){var n=this;return n.app=e.app,n.index=function(){var e=templatizer.partner.index;n.app.setView(e)},n.ibi=function(e){n.app.setView(templatizer.partner.ibi)},n},ns("lending.core").api=function(){var e=this;return e.baseUrl="localhost"===window.location.hostname||0===window.location.hostname.indexOf("192.168")?"http://"+window.location.hostname+":4000/":window.location.hostname.indexOf("beta")>=0?"http://api-beta.finanzero.com.br/":"https://api.finanzero.com.br/",e.eventHandlers={},e.auth={validate:function(n){e.post("/auth/validate",{},n)},requestCode:function(n,t,i){e.post("/auth/request-code",{email:n,personalNumber:t},i)},loginWithCode:function(n,t,i){e.post("/auth/login/code",{key:n,code:t},i)},loginWithPassword:function(n,t){e.post("/auth/login/password",n,t)},activatePassword:function(n,t,i){e.put("/auth/"+n+"/password",t,i)},deactivatePassword:function(n,t){e.del("/auth/"+n+"/password",t)},create:function(n,t){e.post("/auth",n,t)},update:function(n,t,i){e.put("/auth/"+n,t,i)},findAll:function(n,t,i){var o="/auth?";for(var a in t)o+="&"+a+"="+encodeURIComponent(t[a]);e.get(o,i)},findFromId:function(n,t){e.get("/auth/"+n,t)},allGroups:function(n){e.get("/auth/groups",n)}},e.applications={init:function(n,t){e.post("/applications/init",n,t)},changeState:function(n,t,i){e.post("/applications/"+n+"/change-state",t,i)},findFromId:function(n,t){e.get("/applications/"+n,t)},findCpf:function(n,t){e.get("/applications/queryexists?personalNumber="+n,t)},update:function(n,t,i){e.put("/applications/"+n,t,i)},postApplication:function(n,t,i){e.post("/applications/"+n+"/apply",t,i)},leads:function(n,t){e.get("/applications/leads?page="+n,t)},leadsSg:function(n,t){e.get("/applications/leads?page="+n+"&securityType=no-security",t)},all:function(n,t){e.get("/applications/all?page="+n,t)},filter:function(n,t,i){var o="";o+="page="+t+"&";for(var a in n)o+=a+"="+n[a]+"&";e.get("/applications/all?"+o,i)},started:function(n,t){e.get("/applications/started?page="+n,t)},startedSg:function(n,t){e.get("/applications/started?page="+n+"&securityType=no-security",t)},hasBids:function(n,t){e.get("/applications/has-bids?page="+n,t)},archive:function(n,t){e.get("/applications/archive?page="+n,t)},followUp:function(n,t){e.get("/applications/follow-up?page="+n,t)},closed:function(n,t){e.get("/applications/closed?page="+n,t)},markAsFollowedUp:function(n,t,i){e.post("/applications/"+n+"/follow-up",t,i)},hasAccept:function(n,t){e.get("/applications/has-accept?page="+n,t)},getAndLockLead:function(n){e.post("/applications/leads/claim",{},n)},getAndLockApplication:function(n){e.post("/applications/claim",{},n)},postpone:function(n,t,i){e.post("/applications/"+n+"/postpone",t,i)},me:function(n){e.get("/applications/me",n)},addBid:function(n,t,i){e.post("/applications/"+n+"/bids",t,i)},acceptBid:function(n,t,i){e.post("/applications/"+n+"/bids/"+t+"/accept",{},i)},removeBid:function(n,t,i){e.del("/applications/"+n+"/bids/"+t,{},i)},startAuction:function(n,t,i){e.post("/applications/"+n+"/start-auction",t,i)},completedApplication:function(n,t,i){e.post("/applications/"+n+"/completed",t,i)},simulate:function(n,t,i){e.post("/applications/"+n+"/simulate",t,i)},biddableForCurrentSupplier:function(n){e.get("/suppliers/me/applications/open?pageSize=100",n)},close:function(n,t,i){e.post("/applications/"+n+"/close",t,i)},acceptsimulation:function(n,t,i){e.post("/applications/"+n+"/acceptsimulation",t,i)},addComment:function(n,t,i){e.post("/applications/"+n+"/comments",t,i)}},e.suppliers={create:function(n,t){e.post("/suppliers",n,t)},update:function(n,t,i){e.put("/suppliers/"+n,t,i)},me:function(n){e.get("/suppliers/me",n)},findAll:function(n,t){e.get("/suppliers?page="+n,t)},findFromId:function(n,t){e.get("/suppliers/"+n,t)}},e.domains={getPropertyTypes:function(n){e.domains.getDomain("property-type",n)},getConstructionTypes:function(n){e.domains.getDomain("construction-type",n)},getAccountTypes:function(n){e.domains.getDomain("account-type",n)},getLoanReasons:function(n){e.domains.getDomain("loan-reason",n)},getDomain:function(n,t){e.chachedDomains[n]?t&&t(null,e.chachedDomains[n]):e.get("/domains/"+n,t)}},e.loadDomains=function(){e.chachedDomains={},e.get("/domains",function(n,t){null===n?e.chachedDomains=t:console.warn("Error loading Domains")})},e.campaigns={getFromAppId:function(n,t,i){e.get("/campaigns/newoffer/"+n+"/"+t+"?t="+(new Date).valueOf(),i)},cloneApplication:function(n,t,i){e.post("/campaigns/newoffer/"+n,t,i)}},e.on=function(n,t){e.eventHandlers.hasOwnProperty(n)||(e.eventHandlers[n]=[]),e.eventHandlers[n].push(t)},e.trigger=function(n){if(e.eventHandlers.hasOwnProperty(n))for(var t=0;t<e.eventHandlers[n].length;t++)e.eventHandlers[n][t]()},e.apiUrl=function(n){return 0===n.indexOf("/")&&(n=n.slice(1)),e.baseUrl+n},e.request=function(n,t,i,o){$.ajax({type:n,url:e.apiUrl(t),data:null!==i?JSON.stringify(i):null,contentType:"application/json",success:function(e){o(null,e)},headers:{Authorization:e.tokenProvider()}}).fail(function(n){if(403===n.status)return e.trigger("logged-out"),void o(n,null);if(""!==n.responseText)try{n=JSON.parse(n.responseText)}catch(t){n={error:n.responseText}}else n={error:n};o(n,null)})},e.del=function(n,t){e.request("DELETE",n,null,t)},e.get=function(n,t){e.request("GET",n,null,t)},e.post=function(n,t,i){e.request("POST",n,t,i)},e.put=function(n,t,i){e.request("PUT",n,t,i)},e},ns("lending.core").router=function(e){var n=this;return n.routeMap=e.routeMap,n.init=function(e){n.route(),$("body").on("click","a",function(e){var t=$(this);if("_blank"!==t.attr("target")){var i=window.location.hostname+(window.location.port?":"+window.location.port:"");i===t.context.host&&["/"].indexOf(t.context.pathname)===-1&&(e.preventDefault(),n.routeTo(t.attr("href")))}}),window.addEventListener("popstate",function(e){return n.stateHasPushed&&["/"].indexOf(window.location.pathname)!==-1?void(window.location.href="/"):void n.route()},!1)},n.routeTo=function(e){history.pushState({page:e},e,e);dataLayer.push({event:"VirtualPageview",virtualPageURL:e,virtualPageTitle:""}),n.stateHasPushed=!0,n.route()},n.route=function(){var e=window.location.pathname,t=function(e){for(var n in e)if(0===n.indexOf(":"))return e[n];return null},i=splitRemoveEmpty(e,"/");0===i.length&&n.routeMap.__home();for(var o=[],a=n.routeMap,r=0;r<i.length;r++){var s=i[r],l=a[s],d=t(a);if(isFunction(l))l.apply(null,o);else if(r===i.length-1&&"undefined"!=typeof l&&isFunction(l.index))l.index.apply(null,o);else if(isObject(l))a=l;else{if(null===d){n.routeMap.__404();break}if(o.push(s),r===i.length-1){if(isFunction(d.index)){d.index.apply(null,o);break}}else a=d}}},n},ns("lending.components.application").applicationDownloadCsvButton=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.data("application-id"),n.$el.on("click",function(){window.app.api.applications.findFromId(n.applicationId,function(e,n){return e?void alert(e):void CSVExport.csvDownload([n],"application")})}),n},ns("lending.components.application").applicationDownloadCsvExcelButton=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.data("application-id"),n.$el.on("click",function(){window.app.api.applications.findFromId(n.applicationId,function(e,n){return e?void alert(e):void CSVExport.csvDownload([n],"application",lending.components.application.makeBankCSVExportOptions())})}),n},registerComponent(".application-csv-download",lending.components.application.applicationDownloadCsvButton),registerComponent(".application-csv-excel-download",lending.components.application.applicationDownloadCsvExcelButton),ns("lending.components.application").applicationExporter=function(e){var n=this;return n.$el=e,n.$status=n.$el.find('[name="status"]'),n.$securityType=n.$el.find('[name="securityType"]'),n.$securityIsOwned=n.$el.find('[name="securityIsOwned"]'),n.$createdAfter=n.$el.find('[name="createdAfter"]'),n.$outputFormat=n.$el.find('[name="outputFormat"]'),n.recursiveDownload=function(e,n){var t=[],i=function(o){window.app.api.applications.filter(e,o,function(e,a){return e?void n(e,null):(Array.prototype.push.apply(t,a),void((1e3!==t.length||confirm("Exporting more than 1000 customers. Are you sure you want to continue?"))&&(50===a.length?i(++o):n(null,t))))})};i(1)},n.$el.on("submit",function(e){e.preventDefault();var t={},i=n.$status.val();if(""===i)return void alert("Select status");var o=n.$outputFormat.val();if(""===o)return void alert("Select output format");t.state=i;var a=n.$securityType.val();""!==a&&(t.securityType=a);var r=n.$securityIsOwned.val();""!==r&&(t.securityIsOwned=r);var s=Date.parse(n.$createdAfter.val());isNaN(s)||(t.createdAfter=new Date(s).toISOString()),n.recursiveDownload(t,function(e,n){if(e)return void alert("Couldn't download applications "+e);var t;"portocred"==o&&(t=lending.components.application.makeBankCSVExportOptions()),CSVExport.csvDownload(n,"applications-export",t)})}),n},ns("lending.components.application").makeBankCSVExportOptions=function(){var e=function(e){return"0001"===e.slice(0,4)?"":moment(e).format("DD/MM/YYYY")},n=function(e){return'="'+e+'"'},t=function(e){var n=String(e);return n.replace(".",",")},i=function(e){switch(e){case"checking":return"Conta Corrente";case"savings":return"Conta Poupança";case"salary":return"Conta Salário";default:return""}},o=function(e){return e?"Sim":e===!1?"Não":""},a=function(e){switch(e){case"private-employee":return"Empregado privado";case"public-employee":return"Empregado público";case"independent-contractor":return"Autônomo";case"business-owner":return"Empresário";case"liberal-professional":return"Liberal";case"retired":return"Aposentado-Pensionista";case"unemployed":return"Desempregado";default:return"? ("+e+")"}},r={fields:[{key:"firstName",name:"Nome"},{key:"lastName",name:"Sobrenome"},{key:"personalNumber",name:"CPF",format:n},{key:"email",name:"E-mail"},{key:"telephoneNumber",name:"Celular",format:n},{key:"homePhoneNumber",name:"Telefone fixo"},{key:"workStatus",name:"Ocupação",format:a},{key:"appliedAmount",name:"Valor emprestimo",format:t},{key:"loanPeriodInMonths",name:"Período empréstimo",format:t},{key:"birthDate",name:"Data nascimento",format:e},{key:"mothersName",name:"Nome da mãe"},{key:"RG",name:"RG"},{key:"RGExpeditionDate",name:"Emissão do RG",format:e},{key:"zipCode",name:"CEP",format:n},{key:"address1",name:"Endereço"},{key:"streetNumber",name:"Número/Complemento"},{key:"neighbourhood",name:"Bairro"},{key:"city",name:"Cidade"},{key:"state",name:"Estado"},{key:"accountType",name:"Tipo conta",format:i},{key:"monthlyIncome",name:"Renda mensal",format:t},{key:"householdMonthlyIncome",name:"Renda familiar",format:t},{key:"hasCreditRestrictions",name:"Restrições Credito",format:o}]};return r},registerComponent(".application-exporter",lending.components.application.applicationExporter),ns("lending.components.auctions").acceptBidForm=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="applicationId"]').val(),n.bidId=n.$el.find('[name="bidId"]').val(),n.$el.on("submit",function(e){e.preventDefault();gatherFormData(n.$el);window.app.api.applications.acceptBid(n.applicationId,n.bidId,function(e){return e?void alert(e):void window.app.router.routeTo("/me/applications/"+n.applicationId+"/offers/"+n.bidId+"/accepted")})}),n},registerComponent(".accept-bid-form",lending.components.auctions.acceptBidForm),ns("lending.components.auctions").auctionForm=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.$placeBidForm=n.$el.find(".place-bid form"),n.$rejectBidForm=n.$el.find(".reject-bid form"),window.app.api.suppliers.me(function(e,t){n.supplierId=t.id}),n.$placeBidForm.on("submit",function(e){if(e.preventDefault(),!validateForm(n.$placeBidForm))return void n.$el.find(".errors").show();n.$el.find(".errors").hide();var t=gatherFormData(n.$placeBidForm,{approvedAmount:moneyToNumber,approvedPeriodMonths:Number,interestRate:Number,monthlyInstallment:moneyToNumber,totalAnnualInterestRate:Number});t.supplierId=n.supplierId,window.app.api.applications.addBid(n.applicationId,t,function(e,n){e&&alert(e.error),window.app.router.routeTo("/supplier")})}),n.$rejectBidForm.on("submit",function(e){e.preventDefault();var t=gatherFormData(n.$rejectBidForm,{});t.rejected=!0,t.supplierId=n.supplierId,console.log("data:",t),window.app.api.applications.addBid(n.applicationId,t,function(e,n){e&&alert(e.error),window.app.router.routeTo("/supplier")})}),n},registerComponent(".auction-form",lending.components.auctions.auctionForm),ns("lending.components.auctions").auctionList=function(e){var n=this;return n.$e=e,n.$itemTemplate=n.$e.find(".auction-list-item"),n.$itemTemplate.remove(),n.$itemsContainer=n.$e.find(".auction-list-items"),n.$auctionListHeaders=n.$e.find(".auction-list-header"),n.$noItemsContainer=n.$e.find(".auction-list-noitems"),n.init=function(){window.app.api.applications.biddableForCurrentSupplier(function(e,t){return e?void alert(e):0===t.length?(n.$noItemsContainer.show("fast"),void n.$auctionListHeaders.hide()):void $.each(t,function(e,t){var i=n.$itemTemplate.clone();populate(i)["with"](t),value=t.appliedAmount>0?numeral(t.appliedAmount).format("$ 0,0"):"financiamento",i.find(".applied-amount").html(value);var o;o="no-security"===t.securityType?"Crédito Pessoal":t.securityIsOwned?"Refinanciamento":"Financiamento",i.find(".application-product").html(o),i.find(".time-left").html(moment(t.auction.endDate).fromNow()),i.find(".actions a").attr("href","/supplier/applications/"+t.id),n.$itemsContainer.append(i)})})},n},registerComponent(".auction-list",lending.components.auctions.auctionList),ns("lending.components.auth").authForm=function(e){var n=this;return n.$el=e,n.$form=e,n.existingId=n.$form.find('[name="id"]').val(),n.$groupSelect=n.$form.find('select[name="group"]'),n.$groupInput=n.$form.find('input[name="group"]'),n.$groupToggle=n.$form.find(".group-toggle"),n.$supplierSelect=n.$form.find('select[name="supplierId"]'),n.saveUser=function(){if(validateForm(n.$form)){var e=gatherFormData(n.$form);n.$groupSelect.is(":visible")?e.group=n.$groupSelect.val():e.group=n.$groupInput.val();var t=function(e,n){return null!==e?void(e.error&&alert(e.error)):void window.app.router.routeTo("/admin/auth")};n.existingId?window.app.api.auth.update(n.existingId,e,t):window.app.api.auth.create(e,t)}},n.setNewGroupMode=function(){n.$groupSelect.hide(),n.$groupInput.show()},n.setExistingGroupMode=function(){n.$groupSelect.show(),n.$groupInput.hide()},n.init=function(){n.$form.on("submit",function(e){e.preventDefault(),n.saveUser()}),n.$groupToggle.on("click",function(){n.$groupSelect.is(":visible")?(n.setNewGroupMode(),n.$groupToggle.html("Select existing group")):(n.setExistingGroupMode(),n.$groupToggle.html("Create new group"))}),window.app.api.auth.allGroups(function(e,t){if(!e){0===t.length?n.setNewGroupMode():n.setExistingGroupMode();for(var i=0;i<t.length;i++){var o=t[i];n.$groupSelect.append($('<option value="'+o+'">'+o+"</>"))}}}),n.existingId&&window.app.api.auth.findFromId(n.existingId,function(e,t){populate(n.$form)["with"](t),n.$groupInput.val("")})},n},registerComponent(".auth-form",lending.components.auth.authForm),ns("lending.components.auth").authList=function(e){var n=this;return n.$e=e,n.$itemTemplate=n.$e.find(".auth-list-item"),n.$itemTemplate.remove(),n.$itemsContainer=n.$e.find(".auth-list-items"),n.init=function(){var e=querystring("role")||"admin";window.app.api.auth.findAll(1,{role:e},function(e,t){$.each(t,function(e,t){var i=n.$itemTemplate.clone();i.find(".name").html(t.name),i.find(".email").html(t.email),i.find(".telephoneNumber").html(t.telephoneNumber),i.find(".role").html(t.role),i.find(".group").html(t.group),i.find(".details").attr("href","/admin/auth/"+t.id),n.$itemsContainer.append(i)})})},n},registerComponent(".auth-list",lending.components.auth.authList),ns("lending.components.auth").authPasswordForm=function(e){var n=this;return n.$el=e,n.existingId=n.$el.find('[name="id"]').val(),n.$activatePassword=n.$el.find(".activate-password"),n.$deactivatePassword=n.$el.find(".deactivate-password"),n.init=function(){window.app.api.auth.findFromId(n.existingId,function(e,t){t.loginWithPassword?(n.$deactivatePassword.show(),n.$activatePassword.hide()):(n.$activatePassword.show(),n.$deactivatePassword.hide())})},n.$activatePassword.find(".btn").on("click",function(e){if(e.preventDefault(),validateForm(n.$el)){var t=gatherFormData(n.$el);window.app.api.auth.activatePassword(n.existingId,t,function(e){return e?void alert(e.error):void n.init()})}}),n.$deactivatePassword.find(".btn").on("click",function(e){e.preventDefault(),window.app.api.auth.deactivatePassword(n.existingId,function(e){return e?void alert(e.error):void n.init()})}),n},registerComponent(".auth-password-form",lending.components.auth.authPasswordForm),ns("lending.components.crm").applicationBids=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.data("application-id"),n.$el.find(".request-new").on("click",function(){if(confirm("Tem certeza que quer solicitar nova proposta?")){var e=$(this).data("bid-id");window.app.api.applications.removeBid(n.applicationId,e),window.location.href=window.location.href}}),n.$el.find(".accept-bid").on("click",function(){if(confirm("Tem certeza que quer aceitar essa proposta?")){var e=$(this).data("bid-id");window.app.api.applications.acceptBid(n.applicationId,e),window.location.href=window.location.href}}),n},registerComponent(".application-bids",lending.components.crm.applicationBids),ns("lending.components.crm").applicationComments=function(e){var n=this;return n.$el=e,n.$commentForm=n.$el.find("form"),n.applicationId=n.$el.find('[name="applicationId"]').val(),n.$commentForm.on("submit",function(e){e.preventDefault(),data=gatherFormData(n.$commentForm,{}),data.notify="on"===data.notify,window.app.api.applications.addComment(n.applicationId,data,function(e,n){return e?void alert(e.error):void(window.location.href=window.location.href)})}),n},registerComponent(".application-comments",lending.components.crm.applicationComments),ns("lending.components.crm").applicationFormCrm=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.$startAuctionButton=n.$el.find(".btn.start-auction"),n.$postponeButton=n.$el.find(".btn.postpone"),n.$trashButton=n.$el.find(".btn.trash"),n.$followUpButton=n.$el.find(".btn.follow-up"),n.$saveButton=n.$el.find(".btn.save"),n.$zipcodeInput=n.$el.find('[name="zipCode"]'),n.lookupCEP=function(e){VIACep.lookupCEP(e,function(e,t){e||(n.$el.find('[name="city"]').val(t.city),n.$el.find('[name="address1"]').val(t.street),n.$el.find('[name="neighbourhood"]').val(t.neighbourhood),n.$el.find('[name="state"]').val(t.state))})},""!=n.$zipcodeInput.val()&&n.lookupCEP(n.$zipcodeInput.val()),n.$zipcodeInput.on("keyup",debounce(function(){n.lookupCEP(n.$zipcodeInput.val()),n.save(function(){})},500)),n.save=function(e){var t=gatherFormData(n.$el,{accountMonthsActive:Number,appliedAmount:moneyToNumber,householdSize:Number,loanPeriodInMonths:Number,serasaScore:Number,monthlyIncome:moneyToNumber,"vehicleSecurity.modelYear":Number,"vehicleSecurity.value":moneyToNumber,"vehicleSecurity.registrationNumber":stringToUpper,"vehicleSecurity.manufacturingYear":Number,"vehicleSecurity.modelYear":Number,"vehicleSecurity.numberOfExistingLoans":Number,"vehicleSecurity.valueOfExistingLoans":Number,"vehicleSecurity.numberOfExistingLoans":Number,"vehicleSecurity.downPayment":moneyToNumber});window.app.api.applications.update(n.applicationId,t,function(t,i){i.securityIsOwned=i.securityIsOwned?"true":"false",populate(n.$el)["with"](i),populate($("#postpone-modal"))["with"](i),populate($("#close-modal"))["with"](i),e(t,i)})},n.startAuction=function(){validateForm(n.$el)&&n.save(function(e,t){window.app.api.applications.startAuction(n.applicationId,{revision:t.revision},function(e,n){return e?void alert("Error starting auction",e):void(window.location.href="/crm")})})},n.postpone=function(){n.save(function(e,n){$("#postpone-modal").find('[name="revision"]').val(n.revision),_modalManager.toggleModal("#postpone-modal")})},n.trash=function(){n.save(function(e,n){$("#close-modal").find('[name="revision"]').val(n.revision),_modalManager.toggleModal("#close-modal")})},n.followUp=function(){n.save(function(e,t){window.app.api.applications.markAsFollowedUp(n.applicationId,{revision:t.revision},function(e){return e?void alert(e):void(window.location.href="/crm")})})},n.init=function(){n.$el.on("submit",function(e){e.preventDefault()}),n.$startAuctionButton.on("click",n.startAuction),n.$postponeButton.on("click",n.postpone),n.$trashButton.on("click",n.trash),n.$followUpButton.on("click",n.followUp),n.$saveButton.on("click",function(){n.save(function(){validateForm(n.$el)})})},n},registerComponent(".application-form-crm",lending.components.crm.applicationFormCrm),ns("lending.components.crm").applicationStatusPicker=function(e){var n=this;return n.$el=e,n.$el.on("change",function(){window.app.router.routeTo("/crm/applications/?status="+n.$el.val())}),n},registerComponent(".application-status-picker",lending.components.crm.applicationStatusPicker),ns("lending.components.crm").changeState=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.revision=n.$el.find('[name="revision"]').val(),n.init=function(){n.$el.find("button").on("click",function(e){e.preventDefault();var t=$(this),i=t.data("state");window.app.api.applications.changeState(n.applicationId,{applicationState:i,revision:n.revision},function(e,t){return e?void alert(e.error):void window.app.router.routeTo("/admin/applications/"+n.applicationId)})})},n},registerComponent(".application-change-state",lending.components.crm.changeState),ns("lending.components.crm").closeModal=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.init=function(){n.$el.on("click",".warning",function(e){e.preventDefault();var t=n.$el.find('[name="revision"]').val(),i=n.$el.find('[name="reason"]').val();window.app.api.applications.close(n.applicationId,{reason:i,revision:t},function(e,n){return e?void alert(e):(_modalManager.hideModal(),void window.app.router.routeTo("/crm"))})})},n},registerComponent(".close-application",lending.components.crm.closeModal),ns("lending.components.crm").crmCardFlow=function(e){var n=this;return n.$el=e,n.minQuoteTime=0,n.isAdvisor=!!n.$el.data("is-advisor"),n.$nextLeadContainer=n.$el.find(".next-lead-container"),n.$nextLeadButton=n.$el.find(".next-lead"),n.$cardContainer=n.$el.find(".card-container"),n.$noLeadsContainer=n.$el.find(".no-leads"),n.nextAction=function(){window.app.showLoader();var e=n.isAdvisor?window.app.api.applications.getAndLockApplication:window.app.api.applications.getAndLockLead;e(function(e,t){return window.app.hideLoader(),e?void alert(e.error):t?void window.app.router.routeTo("/crm/applications/"+t.id):void n.$noLeadsContainer.show()})},n.$nextLeadButton.on("click",n.nextAction),n},registerComponent(".crm-card-flow",lending.components.crm.crmCardFlow),ns("lending.components.crm").postponeApplicationForm=function(e){var n=this;return n.$el=e,n.applicationId=n.$el.find('[name="id"]').val(),n.init=function(){n.$el.on("click",".primary",function(e){e.preventDefault();var t=n.$el.find('[name="minutes"]').val(),i=n.$el.find('[name="revision"]').val();window.app.api.applications.postpone(n.applicationId,{minutes:Number(t),revision:i},function(e,n){_modalManager.hideModal(),window.app.router.routeTo("/crm")})})},n},registerComponent(".postpone-application",lending.components.crm.postponeApplicationForm),ns("lending.components.forms").dateEditor=function(e){var n=this;return n.$el=e,n.$value=n.$el.find('[type="hidden"]'),n.$year=n.$el.find("select.year"),n.$month=n.$el.find("select.month"),n.$day=n.$el.find("select.day"),n.initialYear=n.$el.data("initial-year")||(new Date).getUTCFullYear(),n.isMonthSelector=n.$el.hasClass("month-editor"),""==n.$value.val()?n.initialValue=new Date(0,0,0,0,0,0,0,0):n.initialValue=new Date(n.$value.val()),n.previousDate=n.initialValue,n.init=function(){var e=n.initialYear,t=0;for(n.$year.append('<option value="">Ano</option>'),t=e;t>e-100;t--)n.$year.append($('<option value="'+t+'">'+t+"</option>"));for(n.$month.append('<option value="">Mês</option>'),t=1;t<=12;t++)n.$month.append($('<option value="'+t+'">'+t+"</option>"));n.updateDays(),n.setInitialSelected()},n.setInitialSelected=function(){n.initialValue.getFullYear()<=1900?(n.$year.val(""),n.$month.val(""),n.$day.val("")):(n.$year.val(n.initialValue.getUTCFullYear()),n.$month.val(n.initialValue.getUTCMonth()+1),n.$day.val(n.initialValue.getUTCDate()))},n.getYear=function(){return Number(n.$year.val())},n.getMonth=function(){return Number(n.$month.val())},n.getDay=function(){return n.isMonthSelector?1:Number(n.$day.val())},n.updateDays=function(){if(n.isMonthSelector===!0)return void n.handleUpdate();var e=n.$day.val();n.$day.html("");var t=n.daysInMonth(n.getYear(),n.getMonth());n.$day.append('<option value="">Dia</option>');for(var i=1;i<=t;i++)n.$day.append($('<option value="'+i+'">'+i+"</option>"));e<=t&&n.$day.val(e),n.handleUpdate()},n.daysInMonth=function(e,n){return new Date(e,n,0).getDate()},n.handleUpdate=function(){var e=new Date(Date.UTC(n.getYear(),n.getMonth()-1,n.getDay(),0,0));0!==n.getYear()&&0!==n.getMonth()&&0!==n.getDay()&&n.$value.val(e.toISOString()),
n.previousDate=e},n.isMonthSelector?n.$month.on("change",n.handleUpdate):n.$month.on("change",function(){n.updateDays()}),n.$year.on("change",function(){n.updateDays()}),n.$day.on("change",n.handleUpdate),n},ns("lending.components.forms").yearEditor=function(e){var n=this;return n.$el=e,n.$year=n.$el.find("select"),n.updateYears=function(e){var t=n.$year.val(),i=e.future||1,o=(new Date).getFullYear();i+=o;var a=e.past||110;a=o-a,n.$year.html(""),n.$year.append('<option value="">Selecione...</option>');for(var r=i;r>=a;r--)n.$year.append($('<option value="'+r+'">'+r+"</option>"));n.$year.val(t)},n.$year.on("listReload",function(e,t){n.updateYears(t)}),n},registerComponent(".date-editor, .month-editor",lending.components.forms.dateEditor),registerComponent(".year-editor",lending.components.forms.yearEditor),ns("lending.components.forms").bankAccountEditor=function(e){var n=this;n.$el=e,n.$value=n.$el.find('[type="hidden"]'),n.$accountNo=n.$el.find("input.accno"),n.$accountDigit=n.$el.find("input.accdig");var t=n.$value.val().split("-");2==t.length?(n.$accountNo.val(t[0]),n.$accountDigit.val(t[1])):n.$value.val().length>0&&console.warn("account-editor eror:",t),n.buildAccountNumber=function(){var e=n.$accountNo.val(),t=n.$accountDigit.val();t&&t.length&&(e+="-"+t.toUpperCase()),n.$value.val(e)},n.$accountNo.on("blur",n.buildAccountNumber),n.$accountDigit.on("blur",n.buildAccountNumber)},ns("lending.components.forms").propertyTypeEditor=function(e){var n=this;n.$el=e,n.$list=n.$el.find("select"),n.$input=n.$el.find("input"),n.init=function(){window.app.api.domains.getPropertyTypes(function(e,t){n.$list.html(""),n.$list.append('<option value="">Selecione...</option>'),null===e?$.each(t,function(e,t){t.code==n.$input.val()?n.$list.append($('<option value="'+t.code+'" selected>'+t.description+"</option>")):n.$list.append($('<option value="'+t.code+'">'+t.description+"</option>"))}):console.warn("Error retrieving propoertyTypes")})}},ns("lending.components.forms").constructionTypeEditor=function(e){var n=this;n.$el=e,n.$list=n.$el.find("select"),n.$input=n.$el.find("input"),n.init=function(){window.app.api.domains.getConstructionTypes(function(e,t){n.$list.html(""),n.$list.append('<option value="">Selecione...</option>'),null===e?$.each(t,function(e,t){t.code==n.$input.val()?n.$list.append($('<option value="'+t.code+'" selected>'+t.description+"</option>")):n.$list.append($('<option value="'+t.code+'">'+t.description+"</option>"))}):console.warn("Error retrieving propoertyTypes")})}},ns("lending.components.forms").loanReasonEditor=function(e){var n=this;n.$el=e,n.$list=n.$el.find("select"),n.$input=n.$el.find("input"),n.init=function(){window.app.api.domains.getLoanReasons(function(e,t){n.$list.html(""),n.$list.append('<option value="">Selecione...</option>'),null===e?$.each(t,function(e,t){t.code==n.$input.val()?n.$list.append($('<option value="'+t.code+'" selected>'+t.description+"</option>")):n.$list.append($('<option value="'+t.code+'">'+t.description+"</option>"))}):console.warn("Error retrieving propoertyTypes")})}},ns("lending.components.forms").jobPositionEditor=function(e){var n=this;n.$el=e,n.$list=n.$el.find("select"),n.$input=n.$el.find("#init_val"),n.$filter=n.$el.find("#filter"),n.init=function(){window.app.api.domains.getDomain("job-position",function(e,t){n.$list.html("");var i=n.$filter.val();i=i.length>0?"|"+i+"|":null,n.$list.append('<option value="">Selecione...</option>');var o=0;null===e?($.each(t,function(e,t){(!i||t.filter.indexOf(i)>=0)&&(o++,t.code==n.$input.val()?n.$list.append($('<option value="'+t.code+'" selected>'+t.description+"</option>")):n.$list.append($('<option value="'+t.code+'">'+t.description+"</option>")))}),0==o&&n.$list.append('<option value="outros">Outros</option>')):console.warn("Error retrieving job-position")})}},ns("lending.components.forms").setBankName=function(e){var n=this;n.$el=e,n.$list=n.$el.find("select"),n.init=function(){window.app.api.domains.getDomain("bank-name",function(e,t){n.$list.html(""),n.$list.append("<option id='noHover' value=''>Selecione...</option>"),n.$list.append("<option id='noHover' value=''>--- Fechamento por telefone ---</option>");var i=0;null===e?($.each(t,function(e,t){"bvcc"==t.filter&&(n.$list.append($('<option value="'+t.code+'">'+t.description+"</option>")),i++)}),n.$list.append("<option id='noHover' value=''>--- Fechamento nas agências ---</option>"),$.each(t,function(e,t){"bvcc"!=t.filter&&(n.$list.append($('<option value="'+t.code+'">'+t.description+"</option>")),i++)}),0==i&&n.$list.append('<option value="outros">Outros</option>')):console.warn("Error retrieving bank-name")})}},ns("lending.components.forms").accountTypeEditor=function(e){var n=this;n.$el=e,n.$list=n.$el.find("select"),n.$input=n.$el.find("input"),n.init=function(){window.app.api.domains.getAccountTypes(function(e,t){null===e?$.each(t,function(e,t){t.code==n.$input.val()?n.$list.append($('<option value="'+t.code+'" selected>'+t.description+"</option>")):n.$list.append($('<option value="'+t.code+'">'+t.description+"</option>"))}):console.warn("Error retrieving accountType domain values")})}},registerComponent(".bank-account-editor",lending.components.forms.bankAccountEditor),registerComponent(".property-type-editor",lending.components.forms.propertyTypeEditor),registerComponent(".loan-reason-editor",lending.components.forms.loanReasonEditor),registerComponent(".construction-type-editor",lending.components.forms.constructionTypeEditor),registerComponent(".job-position-editor",lending.components.forms.jobPositionEditor),registerComponent(".bank-name-selector",lending.components.forms.setBankName),registerComponent(".account-type-editor",lending.components.forms.accountTypeEditor),ns("lending.components").loginWithCodeForm=function(e){var n=this;return n.$el=e,goTopPage(),n.$emailSection=n.$el.find(".email-section"),n.$emailInput=n.$el.find('[name="email"]'),n.$codeInput=n.$el.find('[name="code"]'),n.$requestCodeButton=n.$el.find(".email-section .btn"),n.$codeSection=n.$el.find(".code-section"),n.$loginButton=n.$el.find(".code-section .btn"),n.$notFoundError=n.$el.find(".not-found"),n.$genericError=n.$el.find(".generic"),key=window.location.href.split("="),null!=key[1]&&36==key[1].length&&($(".fadeOut").hide(),n.$emailSection.hide(),n.$codeSection.show(),n.loginKey=key[1]),n.$requestCodeButton.on("click",function(e){e.preventDefault();var t=n.$emailInput.val().trim();return 0===t.length?void n.$emailInput.focus():(window.app.showLoader(),void window.app.api.auth.requestCode(t,null,function(e,t){return window.app.hideLoader(),null!==e?void("User not found"===e.error?n.$notFoundError.show():n.$genericError.show()):(n.loginKey=t.key,n.$emailSection.hide(),n.$codeSection.show(),void n.$codeInput.focus())}))}),n.$loginButton.on("click",function(e){e.preventDefault();var t=n.$codeInput.val();window.app.api.auth.loginWithCode(n.loginKey,t,function(e,t){return null!==e?void n.$genericError.show():(window.app.setAuth(t.token),window.app.setCurrentUser(t.user),void window.app.routeAfterLogin())})}),n.$emailInput.focus(),n.init=function(){var e=querystring("email");""!==e&&n.$emailInput.val(e)},n},registerComponent(".login-with-code",lending.components.loginWithCodeForm),ns("lending.components").loginWithPasswordForm=function(e){var n=this;return n.$el=e,n.$loginButton=n.$el.find(".btn"),n.$notFoundError=n.$el.find(".not-found"),n.$emailInput=n.$el.find('[name="email"]'),n.$loginButton.on("click",function(e){if(e.preventDefault(),validateForm(n.$el)){var t=gatherFormData(n.$el);window.app.api.auth.loginWithPassword(t,function(e,t){return e?void n.$notFoundError.show():(window.app.setAuth(t.token),window.app.setCurrentUser(t.user),void window.app.routeAfterLogin())})}}),n.$emailInput.focus(),n.init=function(){var e=querystring("email");""!==e&&n.$emailInput.val(e)},n},registerComponent(".login-with-password",lending.components.loginWithPasswordForm),ns("lending.components.supplier").supplierForm=function(e){var n=this;return n.$el=e,n.$form=e,n.existingId=e.find('[name="id"]').val(),n.authSelector=e.find(".auth-selector"),n.selRole=n.authSelector.data("role"),n.selFormName=n.authSelector.data("form-name"),n.saveSupplier=function(){if(validateForm(n.$form)){var e=gatherFormData(n.$form,{users:function(e){return isArray(e)?e:[e]}});e.internalName=e.internalName.toLowerCase();var t=function(e,n){return null!==e?void(e.error&&alert(e.error)):void window.app.router.routeTo("/admin/suppliers")};n.existingId?window.app.api.suppliers.update(n.existingId,e,t):window.app.api.suppliers.create(e,t)}},n.init=function(){n.$form.on("submit",function(e){e.preventDefault(),n.saveSupplier()}),n.existingId&&window.app.api.suppliers.findFromId(n.existingId,function(e,t){if(populate(n.$form)["with"](t),t.internalName.length>0){n.$form.find(".internal-name-input").hide();var i=n.$form.find(".internal-name-show");i.html(t.internalName),i.show()}window.app.api.auth.findAll(1,{role:n.selRole},function(e,i){$.each(i,function(e,t){var i=$('<div class="checkbox-container"></div>'),o=$('<input type="checkbox" name="'+n.selFormName+'" value="'+t.id+'" id="'+t.id+'">'),a=$('<label for="'+t.id+'">'+t.email+"</label>");i.append(o),i.append(a),n.authSelector.append(i)}),checkBoxes=n.$form.find('[name="'+n.selFormName+'"]'),$.each(checkBoxes,function(e,n){var i=t.users.find(function(e){return n.id===e})==n.id;n.checked=i})})})},n},registerComponent(".supplier-form",lending.components.supplier.supplierForm),ns("lending.components.supplier").supplierList=function(e){var n=this;return n.$e=e,n.$itemTemplate=n.$e.find(".supplier-list-item"),n.$itemTemplate.remove(),n.$itemsContainer=n.$e.find(".supplier-list-items"),n.init=function(){window.app.api.suppliers.findAll(1,function(e,t){$.each(t,function(e,t){var i=n.$itemTemplate.clone();i.find(".name").html(t.name),i.find(".websiteUrl").html(t.websiteUrl),i.find(".logo").html("<img src="+t.logoImageUrl+" />"),i.find(".details").attr("href","/admin/suppliers/"+t.id),n.$itemsContainer.append(i)})})},n},registerComponent(".supplier-list",lending.components.supplier.supplierList);